import{_ as W,b as A,h as D,i as y,H as v,r as C,u as S,o as c,e,d as l,l as P,C as F,w as d,v as b,j as x,c as k,F as q,g as H,E as V,t as R}from"./main-Dc7XXzbq.js";import{u as L}from"./pipelines-DgyD-vVk.js";import{A as T}from"./AdminLayout-DxqTGoZO.js";import"./index-B9ygI19o.js";const E={__name:"PipelineCreate",setup(U,{expose:t}){t();const m=v(),r=L(),u=C(!1),f=[{name:"Lead",color:"#6b7280",probability:10,is_won:!1,is_lost:!1},{name:"Qualified",color:"#3b82f6",probability:25,is_won:!1,is_lost:!1},{name:"Proposal",color:"#8b5cf6",probability:50,is_won:!1,is_lost:!1},{name:"Negotiation",color:"#f59e0b",probability:75,is_won:!1,is_lost:!1},{name:"Won",color:"#10b981",probability:100,is_won:!0,is_lost:!1},{name:"Lost",color:"#ef4444",probability:0,is_won:!1,is_lost:!0}],o=S({name:"",description:"",stages:[...f]});function s(){o.stages.push({name:"",color:"#6b7280",probability:50,is_won:!1,is_lost:!1})}function g(n){o.stages.length>2&&o.stages.splice(n,1)}function a(n){o.stages[n].is_won&&(o.stages[n].is_lost=!1,o.stages[n].probability=100)}function B(n){o.stages[n].is_lost&&(o.stages[n].is_won=!1,o.stages[n].probability=0)}async function j(){var h,w;if(!o.name.trim()){alert("Pipeline name is required");return}const n=o.stages.some(i=>i.is_won),M=o.stages.some(i=>i.is_lost);if(!n||!M){alert("Please designate at least one Won stage and one Lost stage");return}u.value=!0;try{const i={name:o.name.trim(),description:o.description.trim()||null,stages:o.stages.map((p,N)=>({name:p.name,color:p.color,probability:p.probability,sort_order:N,is_won:p.is_won,is_lost:p.is_lost}))};await r.createPipeline(i),m.push("/pipelines")}catch(i){console.error("Failed to create pipeline:",i),alert(((w=(h=i.response)==null?void 0:h.data)==null?void 0:w.error)||"Failed to create pipeline. Please try again.")}finally{u.value=!1}}const _={router:m,pipelineStore:r,loading:u,defaultStages:f,form:o,addStage:s,removeStage:g,handleWonChange:a,handleLostChange:B,handleSubmit:j,ref:C,reactive:S,get useRouter(){return v},get usePipelineStore(){return L},AdminLayout:T};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}},I={class:"max-w-3xl mx-auto space-y-6"},O={class:"flex items-center gap-4"},Q={class:"bg-white dark:bg-white/[0.03] rounded-xl border border-gray-200 dark:border-gray-800 p-6"},Y={class:"space-y-4"},z={class:"bg-white dark:bg-white/[0.03] rounded-xl border border-gray-200 dark:border-gray-800 p-6"},G={class:"space-y-3"},J={class:"flex-shrink-0"},K=["onUpdate:modelValue"],X={class:"flex-1 space-y-3"},Z={class:"grid grid-cols-2 gap-3"},$=["onUpdate:modelValue"],ee=["onUpdate:modelValue"],te={class:"flex items-center gap-4"},oe={class:"inline-flex items-center"},re=["onUpdate:modelValue","onChange"],se={class:"inline-flex items-center"},ae=["onUpdate:modelValue","onChange"],ne=["onClick","disabled"],le={class:"flex items-center justify-end gap-3"},ie=["disabled"],de={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"};function ge(U,t,m,r,u,f){const o=A("router-link");return c(),D(r.AdminLayout,null,{default:y(()=>[e("div",I,[l(" Page Header "),e("div",O,[P(o,{to:"/pipelines",class:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},{default:y(()=>[...t[2]||(t[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),_:1}),t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Create Pipeline"),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Set up a new sales pipeline with custom stages ")],-1))]),l(" Form "),e("form",{onSubmit:F(r.handleSubmit,["prevent"]),class:"space-y-6"},[l(" Basic Info "),e("div",Q,[t[6]||(t[6]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Basic Information",-1)),e("div",Y,[e("div",null,[t[4]||(t[4]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Pipeline Name * ",-1)),d(e("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=s=>r.form.name=s),type:"text",required:"",class:"w-full px-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",placeholder:"e.g., Sales Pipeline"},null,512),[[b,r.form.name]])]),e("div",null,[t[5]||(t[5]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Description ",-1)),d(e("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=s=>r.form.description=s),rows:"3",class:"w-full px-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",placeholder:"Describe the purpose of this pipeline..."},null,512),[[b,r.form.description]])])])]),l(" Stages "),e("div",z,[e("div",{class:"flex items-center justify-between mb-4"},[t[8]||(t[8]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Stages",-1)),e("button",{type:"button",onClick:r.addStage,class:"inline-flex items-center gap-1 text-sm text-brand-600 hover:text-brand-700"},[...t[7]||(t[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),x(" Add Stage ",-1)])])]),e("div",G,[(c(!0),k(q,null,H(r.form.stages,(s,g)=>(c(),k("div",{key:g,class:"flex items-start gap-3 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg"},[l(" Color Picker "),e("div",J,[d(e("input",{type:"color","onUpdate:modelValue":a=>s.color=a,class:"w-8 h-8 rounded cursor-pointer border-0"},null,8,K),[[b,s.color]])]),l(" Stage Details "),e("div",X,[e("div",Z,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Name",-1)),d(e("input",{"onUpdate:modelValue":a=>s.name=a,type:"text",required:"",class:"w-full px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",placeholder:"Stage name"},null,8,$),[[b,s.name]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Probability (%)",-1)),d(e("input",{"onUpdate:modelValue":a=>s.probability=a,type:"number",min:"0",max:"100",class:"w-full px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},null,8,ee),[[b,s.probability,void 0,{number:!0}]])])]),e("div",te,[e("label",oe,[d(e("input",{type:"checkbox","onUpdate:modelValue":a=>s.is_won=a,onChange:a=>r.handleWonChange(g),class:"rounded border-gray-300 text-brand-600 focus:ring-brand-500"},null,40,re),[[V,s.is_won]]),t[11]||(t[11]=e("span",{class:"ml-2 text-sm text-gray-600 dark:text-gray-400"},"Won Stage",-1))]),e("label",se,[d(e("input",{type:"checkbox","onUpdate:modelValue":a=>s.is_lost=a,onChange:a=>r.handleLostChange(g),class:"rounded border-gray-300 text-brand-600 focus:ring-brand-500"},null,40,ae),[[V,s.is_lost]]),t[12]||(t[12]=e("span",{class:"ml-2 text-sm text-gray-600 dark:text-gray-400"},"Lost Stage",-1))])])]),l(" Remove Button "),e("button",{type:"button",onClick:a=>r.removeStage(g),class:"flex-shrink-0 p-1 text-gray-400 hover:text-red-600",disabled:r.form.stages.length<=2},[...t[13]||(t[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ne)]))),128))]),t[14]||(t[14]=e("p",{class:"mt-3 text-xs text-gray-500 dark:text-gray-400"},' Tip: You need at least one "Won" stage and one "Lost" stage to properly track deal outcomes. ',-1))]),l(" Actions "),e("div",le,[P(o,{to:"/pipelines",class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700"},{default:y(()=>[...t[15]||(t[15]=[x(" Cancel ",-1)])]),_:1}),e("button",{type:"submit",disabled:r.loading,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed"},[r.loading?(c(),k("span",de)):l("v-if",!0),x(" "+R(r.loading?"Creating...":"Create Pipeline"),1)],8,ie)])],32)])]),_:1})}const me=W(E,[["render",ge],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Pipelines/PipelineCreate.vue"]]);export{me as default};
