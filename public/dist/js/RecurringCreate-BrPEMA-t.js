import{_ as j,b as E,c as i,l as V,e as t,C as P,d as l,w as a,j as y,z as w,F as h,g as S,v as u,a as U,t as b,E as I,i as z,H as q,r as x,q as D,k as N,o as g}from"./main-Dc7XXzbq.js";import{u as M}from"./recurringInvoices-CzEZok1k.js";import{u as R}from"./clients-DtdxGGMB.js";import{P as H}from"./PageBreadcrumb-DDO8EaZt.js";import"./index-B9ygI19o.js";const O={__name:"RecurringCreate",setup(T,{expose:e}){e();const _=q(),o=M(),c=R(),f=x(!1),m=x(""),r=x([]),d=x({client_id:"",title:"",frequency:"monthly",day_of_month:1,start_date:"",end_date:"",max_invoices:null,items:[{description:"",quantity:1,rate:0}],tax_rate:0,payment_terms:"net_30",notes:"",auto_send:!1,auto_payment:!1}),s=D(()=>{const n=d.value.items.reduce((p,v)=>p+v.quantity*v.rate,0),k=n*(d.value.tax_rate/100);return n+k});function B(n){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n||0)}function A(){d.value.items.push({description:"",quantity:1,rate:0})}function F(n){d.value.items.splice(n,1)}async function L(){var n,k;f.value=!0,m.value="";try{const p={...d.value,amount:s.value},v=await o.createSchedule(p);_.push(`/recurring-invoices/${v.id}`)}catch(p){m.value=((k=(n=p.response)==null?void 0:n.data)==null?void 0:k.error)||"Failed to create schedule"}finally{f.value=!1}}N(async()=>{await c.fetchClients(),r.value=c.clients;const n=new Date;n.setDate(n.getDate()+1),d.value.start_date=n.toISOString().split("T")[0]});const C={router:_,recurringStore:o,clientStore:c,loading:f,error:m,clients:r,form:d,total:s,formatCurrency:B,addItem:A,removeItem:F,handleSubmit:L,ref:x,computed:D,onMounted:N,get useRouter(){return q},get useRecurringInvoiceStore(){return M},get useClientStore(){return R},PageBreadcrumb:H};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}},Q={class:"rounded-2xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] p-6"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},G=["value"],J={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},K=["value"],X={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Y={class:"border-t dark:border-gray-700 pt-6"},Z={class:"mb-6"},$={class:"overflow-x-auto"},tt={class:"w-full text-sm"},et={class:"px-4 py-2"},rt=["onUpdate:modelValue"],ot={class:"px-4 py-2"},at=["onUpdate:modelValue"],nt={class:"px-4 py-2"},lt=["onUpdate:modelValue"],dt={class:"px-4 py-2 text-right font-medium text-gray-900 dark:text-white"},st={class:"px-4 py-2"},it=["onClick"],ut={class:"bg-gray-50 dark:bg-gray-800"},gt={class:"px-4 py-3 text-right font-bold text-lg text-gray-900 dark:text-white"},yt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},mt={class:"border-t dark:border-gray-700 pt-6 space-y-4"},pt={class:"flex items-center gap-3"},bt={class:"flex items-center gap-3"},xt={key:0,class:"p-4 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400"},ct={class:"flex items-center justify-end gap-4 pt-4 border-t dark:border-gray-700"},ft=["disabled"],kt={key:0,class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"};function vt(T,e,_,o,c,f){const m=E("router-link");return g(),i("div",null,[V(o.PageBreadcrumb,{pageTitle:"Create Recurring Schedule"}),t("div",Q,[t("form",{onSubmit:P(o.handleSubmit,["prevent"]),class:"space-y-6"},[l(" Basic Info "),t("div",W,[t("div",null,[e[13]||(e[13]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"},[y(" Client "),t("span",{class:"text-red-500"},"*")],-1)),a(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>o.form.client_id=r),required:"",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},[e[12]||(e[12]=t("option",{value:""},"Select Client",-1)),(g(!0),i(h,null,S(o.clients,r=>(g(),i("option",{key:r.id,value:r.id},b(r.company_name||r.name),9,G))),128))],512),[[w,o.form.client_id]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"},[y(" Title/Description "),t("span",{class:"text-red-500"},"*")],-1)),a(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>o.form.title=r),type:"text",required:"",placeholder:"Monthly Hosting Fee",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},null,512),[[u,o.form.title]])])]),l(" Frequency "),t("div",J,[t("div",null,[e[16]||(e[16]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"},[y(" Frequency "),t("span",{class:"text-red-500"},"*")],-1)),a(t("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>o.form.frequency=r),required:"",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},[...e[15]||(e[15]=[U('<option value="weekly">Weekly</option><option value="bi-weekly">Bi-weekly</option><option value="monthly">Monthly</option><option value="quarterly">Quarterly</option><option value="semi-annually">Semi-Annually</option><option value="annually">Annually</option>',6)])],512),[[w,o.form.frequency]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Day of Month ",-1)),a(t("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>o.form.day_of_month=r),class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},[(g(),i(h,null,S(28,r=>t("option",{key:r,value:r},b(r),9,K)),64))],512),[[w,o.form.day_of_month]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"},[y(" Start Date "),t("span",{class:"text-red-500"},"*")],-1)),a(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>o.form.start_date=r),type:"date",required:"",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},null,512),[[u,o.form.start_date]])])]),l(" End Date & Limit "),t("div",X,[t("div",null,[e[19]||(e[19]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"}," End Date (optional) ",-1)),a(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>o.form.end_date=r),type:"date",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},null,512),[[u,o.form.end_date]]),e[20]||(e[20]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"Leave empty for indefinite billing",-1))]),t("div",null,[e[21]||(e[21]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Max Invoices (optional) ",-1)),a(t("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>o.form.max_invoices=r),type:"number",min:"1",placeholder:"No limit",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},null,512),[[u,o.form.max_invoices,void 0,{number:!0}]]),e[22]||(e[22]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"Stop after generating this many invoices",-1))])]),l(" Invoice Template "),t("div",Y,[e[31]||(e[31]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Invoice Template",-1)),l(" Line Items "),t("div",Z,[e[27]||(e[27]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Line Items ",-1)),t("div",$,[t("table",tt,[e[26]||(e[26]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left"},"Description"),t("th",{class:"px-4 py-3 text-right w-24"},"Qty"),t("th",{class:"px-4 py-3 text-right w-32"},"Rate"),t("th",{class:"px-4 py-3 text-right w-32"},"Amount"),t("th",{class:"px-4 py-3 w-12"})])],-1)),t("tbody",null,[(g(!0),i(h,null,S(o.form.items,(r,d)=>(g(),i("tr",{key:d,class:"border-b dark:border-gray-700"},[t("td",et,[a(t("input",{"onUpdate:modelValue":s=>r.description=s,type:"text",placeholder:"Item description",class:"w-full rounded border-gray-300 dark:border-gray-600 dark:bg-gray-800 text-gray-900 dark:text-white px-2 py-1"},null,8,rt),[[u,r.description]])]),t("td",ot,[a(t("input",{"onUpdate:modelValue":s=>r.quantity=s,type:"number",min:"1",class:"w-full rounded border-gray-300 dark:border-gray-600 dark:bg-gray-800 text-gray-900 dark:text-white px-2 py-1 text-right"},null,8,at),[[u,r.quantity,void 0,{number:!0}]])]),t("td",nt,[a(t("input",{"onUpdate:modelValue":s=>r.rate=s,type:"number",step:"0.01",min:"0",class:"w-full rounded border-gray-300 dark:border-gray-600 dark:bg-gray-800 text-gray-900 dark:text-white px-2 py-1 text-right"},null,8,lt),[[u,r.rate,void 0,{number:!0}]])]),t("td",dt,b(o.formatCurrency(r.quantity*r.rate)),1),t("td",st,[o.form.items.length>1?(g(),i("button",{key:0,type:"button",onClick:s=>o.removeItem(d),class:"p-1 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded"},[...e[23]||(e[23]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,it)):l("v-if",!0)])]))),128))]),t("tfoot",null,[t("tr",null,[t("td",{colspan:"5",class:"px-4 py-2"},[t("button",{type:"button",onClick:o.addItem,class:"text-sm text-brand-600 hover:text-brand-700"}," + Add Line Item ")])]),t("tr",ut,[e[24]||(e[24]=t("td",{colspan:"3",class:"px-4 py-3 text-right font-medium"},"Total per Invoice:",-1)),t("td",gt,b(o.formatCurrency(o.total)),1),e[25]||(e[25]=t("td",null,null,-1))])])])])]),l(" Tax "),t("div",yt,[t("div",null,[e[28]||(e[28]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Tax Rate (%) ",-1)),a(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>o.form.tax_rate=r),type:"number",step:"0.01",min:"0",max:"100",placeholder:"0",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},null,512),[[u,o.form.tax_rate,void 0,{number:!0}]])]),t("div",null,[e[30]||(e[30]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Payment Due ",-1)),a(t("select",{"onUpdate:modelValue":e[8]||(e[8]=r=>o.form.payment_terms=r),class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},[...e[29]||(e[29]=[U('<option value="due_on_receipt">Due on Receipt</option><option value="net_15">Net 15</option><option value="net_30">Net 30</option><option value="net_45">Net 45</option><option value="net_60">Net 60</option>',5)])],512),[[w,o.form.payment_terms]])])])]),l(" Notes "),t("div",null,[e[32]||(e[32]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Notes (included on each invoice) ",-1)),a(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=r=>o.form.notes=r),rows:"3",placeholder:"Notes to include on generated invoices...",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},null,512),[[u,o.form.notes]])]),l(" Settings "),t("div",mt,[e[35]||(e[35]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Settings",-1)),t("label",pt,[a(t("input",{"onUpdate:modelValue":e[10]||(e[10]=r=>o.form.auto_send=r),type:"checkbox",class:"rounded border-gray-300 text-brand-600 focus:ring-brand-500"},null,512),[[I,o.form.auto_send]]),e[33]||(e[33]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Automatically send invoice to client when generated",-1))]),t("label",bt,[a(t("input",{"onUpdate:modelValue":e[11]||(e[11]=r=>o.form.auto_payment=r),type:"checkbox",class:"rounded border-gray-300 text-brand-600 focus:ring-brand-500"},null,512),[[I,o.form.auto_payment]]),e[34]||(e[34]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Automatically charge saved payment method",-1))])]),l(" Error Message "),o.error?(g(),i("div",xt,b(o.error),1)):l("v-if",!0),l(" Actions "),t("div",ct,[V(m,{to:"/recurring-invoices",class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"},{default:z(()=>[...e[36]||(e[36]=[y(" Cancel ",-1)])]),_:1}),t("button",{type:"submit",disabled:o.loading,class:"px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50 flex items-center gap-2"},[o.loading?(g(),i("svg",kt,[...e[37]||(e[37]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):l("v-if",!0),e[38]||(e[38]=y(" Create Schedule ",-1))],8,ft)])],32)])])}const Vt=j(O,[["render",vt],["__file","/home/btafoya/projects/openclient/resources/js/src/views/RecurringInvoices/RecurringCreate.vue"]]);export{Vt as default};
