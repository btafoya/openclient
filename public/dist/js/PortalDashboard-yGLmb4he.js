import{_ as T,b as V,c as s,d as i,e as t,t as d,F as p,g as y,H as b,r as f,k as v,o,n as u,l as j,i as z,j as A}from"./main-DU5QQqOg.js";import{u as w}from"./portal-alxdLwkm.js";import"./index-B9ygI19o.js";const F={__name:"PortalDashboard",setup(_,{expose:r}){r();const x=b(),e=w(),m=f("invoices"),h=[{id:"invoices",name:"Invoices"},{id:"proposals",name:"Proposals"},{id:"payments",name:"Payment History"}];async function g(){try{await Promise.all([e.fetchInvoices(),e.fetchProposals(),e.fetchPayments()])}catch(n){console.error("Failed to load portal data:",n)}}function a(){e.logout(),x.push("/portal")}async function c(n){try{await e.downloadInvoicePdf(n.id)}catch(l){console.error("Failed to download invoice:",l),alert("Failed to download invoice. Please try again.")}}function S(n){x.push(`/portal/invoices/${n.id}/pay`)}function C(n){return Number(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function P(n){return n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"â€”"}function D(n){const l={draft:"bg-gray-100 text-gray-700",sent:"bg-blue-100 text-blue-700",viewed:"bg-purple-100 text-purple-700",paid:"bg-green-100 text-green-700",overdue:"bg-red-100 text-red-700",cancelled:"bg-gray-100 text-gray-500"};return l[n]||l.draft}function I(n){return{sent:"bg-blue-100 text-blue-700",viewed:"bg-purple-100 text-purple-700",accepted:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700",expired:"bg-orange-100 text-orange-700"}[n]||"bg-gray-100 text-gray-700"}function N(n){const l={succeeded:"bg-green-100 text-green-700",pending:"bg-yellow-100 text-yellow-700",processing:"bg-blue-100 text-blue-700",failed:"bg-red-100 text-red-700",refunded:"bg-gray-100 text-gray-500"};return l[n]||l.pending}v(async()=>{if(!e.isAuthenticated&&!await e.restoreSession()){x.push("/portal");return}g()});const k={router:x,portalStore:e,activeTab:m,tabs:h,loadData:g,logout:a,downloadInvoice:c,payInvoice:S,formatCurrency:C,formatDate:P,getStatusClasses:D,getProposalStatusClasses:I,getPaymentStatusClasses:N,ref:f,onMounted:v,get useRouter(){return b},get usePortalStore(){return w}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}},M={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},B={class:"bg-white dark:bg-gray-800 shadow"},H={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center"},U={class:"flex items-center gap-4"},L={class:"text-sm text-gray-600 dark:text-gray-400"},O={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},R={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 mb-8"},E={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},W={class:"flex items-center"},q={class:"ml-4"},G={class:"text-2xl font-bold text-gray-900 dark:text-white"},J={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},K={class:"flex items-center"},Q={class:"ml-4"},X={class:"text-2xl font-bold text-gray-900 dark:text-white"},Y={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},Z={class:"flex items-center"},$={class:"ml-4"},tt={class:"text-2xl font-bold text-gray-900 dark:text-white"},et={class:"border-b border-gray-200 dark:border-gray-700 mb-6"},rt={class:"-mb-px flex space-x-8"},at=["onClick"],st={key:0,class:"space-y-4"},ot={key:0,class:"text-center py-8"},dt={key:1,class:"text-center py-8"},nt={key:2,class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},it={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},lt={class:"divide-y divide-gray-200 dark:divide-gray-700"},ct={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},xt={class:"px-6 py-4 whitespace-nowrap"},gt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},pt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},yt={class:"px-6 py-4 whitespace-nowrap text-right text-sm space-x-2"},ut=["onClick"],mt=["onClick"],ht={key:1,class:"space-y-4"},kt={key:0,class:"text-center py-8"},bt={key:1,class:"text-center py-8"},ft={key:2,class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},vt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},wt={class:"divide-y divide-gray-200 dark:divide-gray-700"},_t={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},St={class:"px-6 py-4 whitespace-nowrap"},Ct={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Pt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},Dt={class:"px-6 py-4 whitespace-nowrap text-right text-sm space-x-2"},It={key:2,class:"space-y-4"},Nt={key:0,class:"text-center py-8"},Tt={key:1,class:"text-center py-8"},Vt={key:2,class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},jt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},zt={class:"divide-y divide-gray-200 dark:divide-gray-700"},At={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},Ft={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},Mt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 capitalize"},Bt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Ht={class:"px-6 py-4 whitespace-nowrap"};function Ut(_,r,x,e,m,h){const g=V("router-link");return o(),s("div",M,[i(" Header "),t("header",B,[t("div",H,[r[0]||(r[0]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Client Portal",-1)),t("div",U,[t("span",L," Welcome, "+d(e.portalStore.clientName),1),t("button",{onClick:e.logout,class:"text-sm font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}," Sign Out ")])])]),t("main",O,[i(" Summary Cards "),t("div",R,[t("div",E,[t("div",W,[r[2]||(r[2]=t("div",{class:"flex-shrink-0 bg-red-100 dark:bg-red-900/20 rounded-md p-3"},[t("svg",{class:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",q,[r[1]||(r[1]=t("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Amount Due",-1)),t("p",G,"$"+d(e.formatCurrency(e.portalStore.totalDue)),1)])])]),t("div",J,[t("div",K,[r[4]||(r[4]=t("div",{class:"flex-shrink-0 bg-blue-100 dark:bg-blue-900/20 rounded-md p-3"},[t("svg",{class:"h-6 w-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t("div",Q,[r[3]||(r[3]=t("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Unpaid Invoices",-1)),t("p",X,d(e.portalStore.unpaidInvoices.length),1)])])]),t("div",Y,[t("div",Z,[r[6]||(r[6]=t("div",{class:"flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/20 rounded-md p-3"},[t("svg",{class:"h-6 w-6 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])],-1)),t("div",$,[r[5]||(r[5]=t("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Pending Proposals",-1)),t("p",tt,d(e.portalStore.pendingProposals.length),1)])])])]),i(" Tabs "),t("div",et,[t("nav",rt,[(o(),s(p,null,y(e.tabs,a=>t("button",{key:a.id,onClick:c=>e.activeTab=a.id,class:u([e.activeTab===a.id?"border-brand-500 text-brand-600 dark:text-brand-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},d(a.name),11,at)),64))])]),i(" Invoices Tab "),e.activeTab==="invoices"?(o(),s("div",st,[e.portalStore.loading?(o(),s("div",ot,[...r[7]||(r[7]=[t("div",{class:"inline-block w-8 h-8 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"},null,-1)])])):e.portalStore.invoices.length===0?(o(),s("div",dt,[...r[8]||(r[8]=[t("p",{class:"text-gray-500 dark:text-gray-400"},"No invoices found",-1)])])):(o(),s("div",nt,[t("table",it,[r[9]||(r[9]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Invoice"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Amount"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Due Date"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",lt,[(o(!0),s(p,null,y(e.portalStore.invoices,a=>(o(),s("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",ct,d(a.invoice_number),1),t("td",xt,[t("span",{class:u(["px-2 py-1 text-xs font-medium rounded-full capitalize",e.getStatusClasses(a.status)])},d(a.status),3)]),t("td",gt," $"+d(e.formatCurrency(a.total)),1),t("td",pt,d(e.formatDate(a.due_date)),1),t("td",yt,[t("button",{onClick:c=>e.downloadInvoice(a),class:"text-brand-600 hover:text-brand-900 dark:text-brand-400 dark:hover:text-brand-300"}," Download ",8,ut),["sent","viewed","overdue"].includes(a.status)?(o(),s("button",{key:0,onClick:c=>e.payInvoice(a),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300"}," Pay Now ",8,mt)):i("v-if",!0)])]))),128))])])]))])):i("v-if",!0),i(" Proposals Tab "),e.activeTab==="proposals"?(o(),s("div",ht,[e.portalStore.loading?(o(),s("div",kt,[...r[10]||(r[10]=[t("div",{class:"inline-block w-8 h-8 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"},null,-1)])])):e.portalStore.proposals.length===0?(o(),s("div",bt,[...r[11]||(r[11]=[t("p",{class:"text-gray-500 dark:text-gray-400"},"No proposals found",-1)])])):(o(),s("div",ft,[t("table",vt,[r[13]||(r[13]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Proposal"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Value"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Valid Until"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",wt,[(o(!0),s(p,null,y(e.portalStore.proposals,a=>(o(),s("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",_t,d(a.title),1),t("td",St,[t("span",{class:u(["px-2 py-1 text-xs font-medium rounded-full capitalize",e.getProposalStatusClasses(a.status)])},d(a.status),3)]),t("td",Ct," $"+d(e.formatCurrency(a.total)),1),t("td",Pt,d(e.formatDate(a.valid_until)),1),t("td",Dt,[j(g,{to:`/portal/proposals/${a.id}`,class:"text-brand-600 hover:text-brand-900 dark:text-brand-400 dark:hover:text-brand-300"},{default:z(()=>[...r[12]||(r[12]=[A(" View ",-1)])]),_:1},8,["to"])])]))),128))])])]))])):i("v-if",!0),i(" Payments Tab "),e.activeTab==="payments"?(o(),s("div",It,[e.portalStore.loading?(o(),s("div",Nt,[...r[14]||(r[14]=[t("div",{class:"inline-block w-8 h-8 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"},null,-1)])])):e.portalStore.payments.length===0?(o(),s("div",Tt,[...r[15]||(r[15]=[t("p",{class:"text-gray-500 dark:text-gray-400"},"No payment history found",-1)])])):(o(),s("div",Vt,[t("table",jt,[r[16]||(r[16]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Invoice"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Method"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Amount"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Status")])],-1)),t("tbody",zt,[(o(!0),s(p,null,y(e.portalStore.payments,a=>{var c;return o(),s("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",At,d(e.formatDate(a.created_at)),1),t("td",Ft,d(a.invoice_number),1),t("td",Mt,d(((c=a.payment_method)==null?void 0:c.replace("_"," "))||"N/A"),1),t("td",Bt," $"+d(e.formatCurrency(a.amount)),1),t("td",Ht,[t("span",{class:u(["px-2 py-1 text-xs font-medium rounded-full capitalize",e.getPaymentStatusClasses(a.status)])},d(a.status),3)])])}),128))])])]))])):i("v-if",!0)])])}const Et=T(F,[["render",Ut],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Portal/PortalDashboard.vue"]]);export{Et as default};
