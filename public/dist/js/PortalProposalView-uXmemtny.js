import{_ as H,b as E,c as a,d as o,e,l as P,i as C,F as g,t as d,n as I,j as y,g as S,w as Y,v as O,I as D,H as j,r as u,q as f,k as V,o as s}from"./main-Dc7XXzbq.js";import{u as B}from"./portal-NE69-AGr.js";import"./index-B9ygI19o.js";const Q={__name:"PortalProposalView",setup(F,{expose:t}){t();const b=D(),r=j(),c=B(),k=u(!0),p=u(!1),n=u(!1),i=u(null),h=u(!1),v=u(""),N=f(()=>{var m;if(!((m=i.value)!=null&&m.valid_until))return!1;const x=(new Date(i.value.valid_until)-new Date)/(1e3*60*60*24);return x<=7&&x>0}),T=f(()=>{var x;const l={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",viewed:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",rejected:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300",expired:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300"};return l[(x=i.value)==null?void 0:x.status]||l.draft}),z=f(()=>{var l,x,m,_;return((x=(l=i.value)==null?void 0:l.status)==null?void 0:x.charAt(0).toUpperCase())+((_=(m=i.value)==null?void 0:m.status)==null?void 0:_.slice(1))||"Draft"});function A(l){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(l||0)}function M(l){return l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}async function L(){p.value=!0;try{await c.acceptProposal(i.value.id,v.value||null),i.value=await c.fetchProposal(b.params.id),h.value=!1}catch(l){console.error("Failed to accept proposal:",l)}finally{p.value=!1}}async function R(){if(confirm("Are you sure you want to decline this proposal?")){p.value=!0;try{await c.rejectProposal(i.value.id),i.value=await c.fetchProposal(b.params.id)}catch(l){console.error("Failed to reject proposal:",l)}finally{p.value=!1}}}async function U(){n.value=!0;try{console.log("Download PDF for proposal:",i.value.id)}catch(l){console.error("Failed to download PDF:",l)}finally{n.value=!1}}function q(){c.logout(),r.push("/portal")}V(async()=>{try{i.value=await c.fetchProposal(b.params.id)}catch(l){console.error("Failed to load proposal:",l)}finally{k.value=!1}});const w={route:b,router:r,portalStore:c,loading:k,processing:p,downloading:n,proposal:i,showSignature:h,signatureName:v,isExpiringSoon:N,statusClass:T,statusLabel:z,formatCurrency:A,formatDate:M,acceptProposal:L,rejectProposal:R,downloadPdf:U,logout:q,ref:u,computed:f,onMounted:V,get useRoute(){return D},get useRouter(){return j},get usePortalStore(){return B}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}},W={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},G={class:"bg-white dark:bg-gray-800 shadow-sm"},J={class:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between"},K={class:"flex items-center gap-4"},X={key:0,class:"flex items-center justify-center py-12"},Z={class:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},$={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden mb-6"},ee={class:"p-6"},te={class:"flex flex-col md:flex-row md:items-start md:justify-between gap-4"},re={class:"text-2xl font-bold text-gray-900 dark:text-white"},oe={class:"text-gray-500 dark:text-gray-400 mt-1"},ae={class:"text-left md:text-right"},se={class:"text-3xl font-bold text-gray-900 dark:text-white"},le={key:0,class:"px-6 py-3 bg-yellow-50 dark:bg-yellow-900/20 border-t border-yellow-200 dark:border-yellow-800"},de={class:"text-sm text-yellow-600 dark:text-yellow-400 flex items-center gap-2"},ne={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden mb-6"},ie={class:"divide-y divide-gray-200 dark:divide-gray-700"},ge={class:"text-lg font-semibold text-gray-900 dark:text-white mb-3"},ce={class:"prose dark:prose-invert max-w-none text-gray-600 dark:text-gray-300 whitespace-pre-wrap"},pe={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden mb-6"},xe={class:"overflow-x-auto"},ue={class:"w-full"},ye={class:"divide-y divide-gray-200 dark:divide-gray-700"},be={class:"px-6 py-4 text-gray-900 dark:text-white"},me={class:"px-6 py-4 text-right text-gray-900 dark:text-white"},fe={class:"px-6 py-4 text-right text-gray-900 dark:text-white"},ke={class:"px-6 py-4 text-right font-medium text-gray-900 dark:text-white"},he={class:"bg-gray-50 dark:bg-gray-900/50"},ve={class:"px-6 py-4 text-right text-xl font-bold text-gray-900 dark:text-white"},we={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6"},_e={class:"text-gray-600 dark:text-gray-300 whitespace-pre-wrap text-sm"},Pe={key:1,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"},Ce={key:0,class:"space-y-4"},Se={class:"flex flex-col sm:flex-row gap-3"},De=["disabled"],je={class:"space-y-4"},Ve={class:"flex flex-col sm:flex-row gap-3"},Be=["disabled"],Fe={key:0,class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},Ne={class:"flex flex-col sm:flex-row gap-3"},Te=["disabled"],ze={key:0,class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},Ae=["disabled"],Me={class:"bg-green-50 dark:bg-green-900/20 rounded-xl border border-green-200 dark:border-green-800 p-6"},Le={class:"flex items-center gap-4"},Re={class:"text-green-600 dark:text-green-400"},Ue={key:0},qe={class:"bg-red-50 dark:bg-red-900/20 rounded-xl border border-red-200 dark:border-red-800 p-6"},He={class:"flex items-center gap-4"},Ee={class:"text-red-600 dark:text-red-400"},Ie={class:"bg-gray-50 dark:bg-gray-900/50 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},Ye={class:"flex items-center gap-4"},Oe={class:"text-gray-600 dark:text-gray-400"},Qe={class:"mt-6 text-center"},We=["disabled"],Ge={class:"text-center py-12"};function Je(F,t,b,r,c,k){const p=E("router-link");return s(),a("div",W,[o(" Portal Header "),e("header",G,[e("div",J,[e("div",K,[P(p,{to:"/portal/dashboard",class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},{default:C(()=>[...t[3]||(t[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1}),t[4]||(t[4]=e("h1",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Proposal Details",-1))]),e("button",{onClick:r.logout,class:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}," Logout ")])]),o(" Loading State "),r.loading?(s(),a("div",X,[...t[5]||(t[5]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-500"},null,-1)])])):r.proposal?(s(),a(g,{key:1},[o(" Proposal Content "),e("main",Z,[o(" Proposal Header "),e("div",$,[e("div",ee,[e("div",te,[e("div",null,[e("h2",re,d(r.proposal.title),1),e("p",oe,"Proposal #"+d(r.proposal.proposal_number),1)]),e("div",ae,[t[6]||(t[6]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Total Value",-1)),e("p",se,d(r.formatCurrency(r.proposal.total)),1),e("span",{class:I(["mt-2 inline-block px-3 py-1 rounded-full text-sm font-medium",r.statusClass])},d(r.statusLabel),3)])])]),o(" Valid Until Warning "),r.proposal.status==="sent"&&r.isExpiringSoon?(s(),a("div",le,[e("p",de,[t[7]||(t[7]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),y(" This proposal expires on "+d(r.formatDate(r.proposal.valid_until)),1)])])):o("v-if",!0)]),o(" Content Sections "),e("div",ne,[e("div",ie,[(s(!0),a(g,null,S(r.proposal.sections,(n,i)=>(s(),a("div",{key:i,class:"p-6"},[e("h3",ge,d(n.title),1),e("div",ce,d(n.content),1)]))),128))])]),o(" Line Items "),e("div",pe,[t[10]||(t[10]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Pricing")],-1)),e("div",xe,[e("table",ue,[t[9]||(t[9]=e("thead",{class:"bg-gray-50 dark:bg-gray-900/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Description"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Qty"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Rate"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amount")])],-1)),e("tbody",ye,[(s(!0),a(g,null,S(r.proposal.items,(n,i)=>(s(),a("tr",{key:i},[e("td",be,d(n.description),1),e("td",me,d(n.quantity),1),e("td",fe,d(r.formatCurrency(n.rate)),1),e("td",ke,d(r.formatCurrency(n.quantity*n.rate)),1)]))),128))]),e("tfoot",he,[e("tr",null,[t[8]||(t[8]=e("td",{colspan:"3",class:"px-6 py-4 text-right font-medium text-gray-900 dark:text-white"},"Total:",-1)),e("td",ve,d(r.formatCurrency(r.proposal.total)),1)])])])])]),o(" Terms "),r.proposal.terms?(s(),a("div",we,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-3"},"Terms & Conditions",-1)),e("p",_e,d(r.proposal.terms),1)])):o("v-if",!0),o(" Action Section "),r.proposal.status==="sent"||r.proposal.status==="viewed"?(s(),a("div",Pe,[t[19]||(t[19]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Your Response",-1)),o(" Signature Section "),r.proposal.require_signature&&!r.showSignature?(s(),a("div",Ce,[t[12]||(t[12]=e("p",{class:"text-gray-600 dark:text-gray-400"}," This proposal requires your signature to accept. Please review the terms carefully before proceeding. ",-1)),e("div",Se,[e("button",{onClick:t[0]||(t[0]=n=>r.showSignature=!0),class:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium"}," Accept & Sign "),e("button",{onClick:r.rejectProposal,disabled:r.processing,class:"flex-1 px-4 py-3 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 font-medium"}," Decline ",8,De)])])):r.proposal.require_signature&&r.showSignature?(s(),a(g,{key:1},[o(" Signature Input "),e("div",je,[t[16]||(t[16]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," By signing below, you agree to the terms and conditions outlined in this proposal. ",-1)),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Your Full Name",-1)),Y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>r.signatureName=n),type:"text",placeholder:"Type your full name",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 text-gray-900 dark:text-white dark:bg-gray-800 focus:ring-2 focus:ring-brand-500"},null,512),[[O,r.signatureName]])]),e("div",Ve,[e("button",{onClick:r.acceptProposal,disabled:r.processing||!r.signatureName,class:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 font-medium flex items-center justify-center gap-2"},[r.processing?(s(),a("svg",Fe,[...t[14]||(t[14]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):o("v-if",!0),t[15]||(t[15]=y(" Submit Signature ",-1))],8,Be),e("button",{onClick:t[2]||(t[2]=n=>r.showSignature=!1),class:"flex-1 px-4 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700"}," Cancel ")])])],2112)):(s(),a(g,{key:2},[o(" No Signature Required "),e("div",Ne,[e("button",{onClick:r.acceptProposal,disabled:r.processing,class:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 font-medium flex items-center justify-center gap-2"},[r.processing?(s(),a("svg",ze,[...t[17]||(t[17]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):o("v-if",!0),t[18]||(t[18]=y(" Accept Proposal ",-1))],8,Te),e("button",{onClick:r.rejectProposal,disabled:r.processing,class:"flex-1 px-4 py-3 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 font-medium"}," Decline ",8,Ae)])],2112))])):r.proposal.status==="accepted"?(s(),a(g,{key:2},[o(" Accepted Status "),e("div",Me,[e("div",Le,[t[21]||(t[21]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-12 h-12 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",null,[t[20]||(t[20]=e("h3",{class:"text-lg font-semibold text-green-800 dark:text-green-200"},"Proposal Accepted",-1)),e("p",Re,[y(" You accepted this proposal on "+d(r.formatDate(r.proposal.accepted_at))+" ",1),r.proposal.signature_name?(s(),a("span",Ue,' and signed as "'+d(r.proposal.signature_name)+'"',1)):o("v-if",!0)])])])])],2112)):r.proposal.status==="rejected"?(s(),a(g,{key:3},[o(" Rejected Status "),e("div",qe,[e("div",He,[t[23]||(t[23]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-12 h-12 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",null,[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold text-red-800 dark:text-red-200"},"Proposal Declined",-1)),e("p",Ee," This proposal was declined on "+d(r.formatDate(r.proposal.rejected_at)),1)])])])],2112)):r.proposal.status==="expired"?(s(),a(g,{key:4},[o(" Expired Status "),e("div",Ie,[e("div",Ye,[t[25]||(t[25]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",null,[t[24]||(t[24]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"Proposal Expired",-1)),e("p",Oe," This proposal expired on "+d(r.formatDate(r.proposal.valid_until))+". Please contact us for a new proposal. ",1)])])])],2112)):o("v-if",!0),o(" Download PDF "),e("div",Qe,[e("button",{onClick:r.downloadPdf,disabled:r.downloading,class:"text-brand-600 hover:text-brand-700 font-medium flex items-center gap-2 mx-auto"},[...t[26]||(t[26]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),y(" Download PDF ",-1)])],8,We)])])],2112)):(s(),a(g,{key:2},[o(" Not Found "),e("div",Ge,[t[28]||(t[28]=e("p",{class:"text-gray-500 dark:text-gray-400"},"Proposal not found.",-1)),P(p,{to:"/portal/dashboard",class:"text-brand-600 hover:text-brand-700 mt-2 inline-block"},{default:C(()=>[...t[27]||(t[27]=[y(" Back to Dashboard ",-1)])]),_:1})])],2112))])}const $e=H(Q,[["render",Je],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Portal/PortalProposalView.vue"]]);export{$e as default};
