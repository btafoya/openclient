import{_ as E,b as I,h as f,i as x,H as _,r as h,q as C,k as S,o as l,e as t,d as n,l as v,j as m,t as d,w as P,v as U,z as R,c as i,F as y,g as q,n as b}from"./main-Dc7XXzbq.js";import{u as j}from"./proposals-D2i0NtR_.js";import{A as G}from"./AdminLayout-DxqTGoZO.js";import"./index-B9ygI19o.js";const O={__name:"ProposalList",setup(F,{expose:e}){e();const g=_(),r=j(),k=h(""),u=h("all"),c=C(()=>{let a=r.filteredProposals;return u.value!=="all"&&(a=a.filter(s=>s.status===u.value)),a});async function o(){try{await r.fetchProposals()}catch(a){console.error("Failed to load proposals:",a)}}function p(){r.setSearchTerm(k.value)}function D(){o()}async function M(a){if(confirm(`Send proposal "${a.title}" to ${a.client_name||"client"}?`))try{await r.sendProposal(a.id)}catch(s){console.error("Failed to send proposal:",s),alert("Failed to send proposal. Please try again.")}}async function T(a){if(confirm(`Convert proposal "${a.title}" to an invoice?`))try{const s=await r.convertToInvoice(a.id);g.push(`/invoices/${s.id}`)}catch(s){console.error("Failed to convert to invoice:",s),alert("Failed to convert to invoice. Please try again.")}}async function V(a){try{const s=await r.duplicateProposal(a.id);g.push(`/proposals/${s.id}/edit`)}catch(s){console.error("Failed to duplicate proposal:",s),alert("Failed to duplicate proposal. Please try again.")}}async function B(a){if(confirm(`Delete proposal "${a.title}"? This cannot be undone.`))try{await r.deleteProposal(a.id)}catch(s){console.error("Failed to delete proposal:",s),alert("Failed to delete proposal. Please try again.")}}function L(a){return Number(a||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function z(a){return a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"â€”"}function A(a){return["accepted","rejected"].includes(a.status)||!a.valid_until?!1:new Date(a.valid_until)<new Date}function H(a){const s={draft:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400",sent:"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400",viewed:"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400",accepted:"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400",rejected:"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400",expired:"bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-400"};return s[a]||s.draft}function N(a){const s={draft:"bg-gray-600",sent:"bg-blue-600",viewed:"bg-purple-600",accepted:"bg-green-600",rejected:"bg-red-600",expired:"bg-orange-600"};return s[a]||s.draft}S(()=>{o()});const w={router:g,proposalStore:r,searchTerm:k,statusFilter:u,displayedProposals:c,loadProposals:o,handleSearch:p,applyFilter:D,sendProposal:M,convertToInvoice:T,duplicateProposal:V,confirmDelete:B,formatCurrency:L,formatDate:z,isExpired:A,getStatusClasses:H,getStatusDotClasses:N,ref:h,computed:C,onMounted:S,get useRouter(){return _},get useProposalStore(){return j},AdminLayout:G};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}},Y={class:"space-y-6"},J={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},K={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Q={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},W={class:"mt-1 text-2xl font-bold text-gray-900 dark:text-white"},X={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},Z={class:"mt-1 text-2xl font-bold text-blue-600"},$={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},tt={class:"mt-1 text-2xl font-bold text-green-600"},et={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},rt={class:"mt-1 text-2xl font-bold text-gray-900 dark:text-white"},ot={class:"flex flex-col gap-4 sm:flex-row sm:items-center"},at={class:"flex-1"},st={class:"relative"},nt={class:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"},lt={key:0,class:"p-8 text-center"},dt={class:"p-8 text-center"},it={class:"mt-4 text-sm text-gray-900 dark:text-white font-medium"},ct={class:"p-8 text-center"},xt={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},pt={class:"max-w-full overflow-x-auto custom-scrollbar"},gt={class:"min-w-full"},ut={class:"divide-y divide-gray-200 dark:divide-gray-700"},mt={class:"px-5 py-4 sm:px-6"},yt={key:0,class:"block text-gray-500 text-theme-xs dark:text-gray-400 mt-0.5"},kt={class:"px-5 py-4 sm:px-6"},ft={class:"text-theme-sm text-gray-700 dark:text-gray-300"},ht={class:"px-5 py-4 sm:px-6"},vt={class:"px-5 py-4 sm:px-6"},bt={class:"text-theme-sm font-medium text-gray-900 dark:text-white"},wt={class:"px-5 py-4 sm:px-6"},_t={class:"px-5 py-4 sm:px-6"},Ct={class:"flex items-center justify-end gap-2"},St=["onClick"],Pt=["onClick"],jt=["onClick"],Ft=["onClick"];function Dt(F,e,g,r,k,u){const c=I("router-link");return l(),f(r.AdminLayout,null,{default:x(()=>[t("div",Y,[n(" Page Header "),t("div",J,[e[3]||(e[3]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Proposals"),t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Create and manage client proposals with e-signature support ")],-1)),v(c,{to:"/proposals/create",class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700"},{default:x(()=>[...e[2]||(e[2]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),m(" New Proposal ",-1)])]),_:1})]),n(" Stats Cards "),t("div",K,[t("div",Q,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Draft",-1)),t("p",W,d(r.proposalStore.draftProposals.length),1)]),t("div",X,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Sent",-1)),t("p",Z,d(r.proposalStore.sentProposals.length),1)]),t("div",$,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Accepted",-1)),t("p",tt,d(r.proposalStore.acceptedProposals.length),1)]),t("div",et,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Total Value",-1)),t("p",rt," $"+d(r.formatCurrency(r.proposalStore.totalValue)),1)])]),n(" Search and Filters "),t("div",ot,[t("div",at,[t("div",st,[P(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.searchTerm=o),type:"text",placeholder:"Search proposals...",class:"w-full px-4 py-2 pl-10 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",onInput:r.handleSearch},null,544),[[U,r.searchTerm]]),e[8]||(e[8]=t("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),P(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.statusFilter=o),onChange:r.applyFilter,class:"px-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},[...e[9]||(e[9]=[t("option",{value:"all"},"All Statuses",-1),t("option",{value:"draft"},"Draft",-1),t("option",{value:"sent"},"Sent",-1),t("option",{value:"viewed"},"Viewed",-1),t("option",{value:"accepted"},"Accepted",-1),t("option",{value:"rejected"},"Rejected",-1),t("option",{value:"expired"},"Expired",-1)])],544),[[R,r.statusFilter]])]),n(" Proposals Table "),t("div",nt,[n(" Loading State "),r.proposalStore.loading?(l(),i("div",lt,[...e[10]||(e[10]=[t("div",{class:"inline-block w-8 h-8 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"Loading proposals...",-1)])])):r.proposalStore.error?(l(),i(y,{key:1},[n(" Error State "),t("div",dt,[e[11]||(e[11]=t("div",{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/20"},[t("svg",{class:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),t("p",it,d(r.proposalStore.error),1),t("button",{onClick:r.loadProposals,class:"mt-4 px-4 py-2 text-sm font-medium text-brand-600 hover:text-brand-700"}," Try Again ")])],2112)):r.displayedProposals.length===0?(l(),i(y,{key:2},[n(" Empty State "),t("div",ct,[e[13]||(e[13]=t("div",{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 dark:bg-gray-800"},[t("svg",{class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),e[14]||(e[14]=t("p",{class:"mt-4 text-sm text-gray-900 dark:text-white font-medium"},"No proposals found",-1)),t("p",xt,d(r.searchTerm?"Try adjusting your search":"Get started by creating your first proposal"),1),r.searchTerm?n("v-if",!0):(l(),f(c,{key:0,to:"/proposals/create",class:"inline-flex items-center gap-2 mt-4 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700"},{default:x(()=>[...e[12]||(e[12]=[m(" Create Your First Proposal ",-1)])]),_:1}))])],2112)):(l(),i(y,{key:3},[n(" Table Content "),t("div",pt,[t("table",gt,[e[21]||(e[21]=t("thead",null,[t("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[t("th",{class:"px-5 py-3 text-left sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Proposal")]),t("th",{class:"px-5 py-3 text-left sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Client")]),t("th",{class:"px-5 py-3 text-left sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Status")]),t("th",{class:"px-5 py-3 text-left sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Value")]),t("th",{class:"px-5 py-3 text-left sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Valid Until")]),t("th",{class:"px-5 py-3 text-right sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Actions")])])],-1)),t("tbody",ut,[(l(!0),i(y,null,q(r.displayedProposals,o=>(l(),i("tr",{key:o.id,class:"border-t border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800/50"},[t("td",mt,[v(c,{to:`/proposals/${o.id}`,class:"block font-medium text-gray-800 text-theme-sm dark:text-white/90 hover:text-brand-600 dark:hover:text-brand-400"},{default:x(()=>[m(d(o.title),1)]),_:2},1032,["to"]),o.project_name?(l(),i("span",yt,d(o.project_name),1)):n("v-if",!0)]),t("td",kt,[t("p",ft,d(o.client_name||"No client"),1)]),t("td",ht,[t("span",{class:b(["inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-full capitalize",r.getStatusClasses(o.status)])},[t("span",{class:b(["w-1.5 h-1.5 rounded-full",r.getStatusDotClasses(o.status)])},null,2),m(" "+d(o.status),1)],2)]),t("td",vt,[t("div",bt," $"+d(r.formatCurrency(o.total)),1)]),t("td",wt,[t("div",{class:b(["text-theme-sm",r.isExpired(o)?"text-red-600 font-medium":"text-gray-600 dark:text-gray-400"])},d(r.formatDate(o.valid_until)),3)]),t("td",_t,[t("div",Ct,[v(c,{to:`/proposals/${o.id}`,class:"p-1.5 text-gray-600 hover:text-brand-600 dark:text-gray-400 dark:hover:text-brand-400",title:"View"},{default:x(()=>[...e[15]||(e[15]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])]),_:1},8,["to"]),o.status==="draft"?(l(),i("button",{key:0,onClick:p=>r.sendProposal(o),class:"p-1.5 text-gray-600 hover:text-green-600 dark:text-gray-400 dark:hover:text-green-400",title:"Send"},[...e[16]||(e[16]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)])],8,St)):n("v-if",!0),o.status==="accepted"?(l(),i("button",{key:1,onClick:p=>r.convertToInvoice(o),class:"p-1.5 text-gray-600 hover:text-green-600 dark:text-gray-400 dark:hover:text-green-400",title:"Convert to Invoice"},[...e[17]||(e[17]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],8,Pt)):n("v-if",!0),t("button",{onClick:p=>r.duplicateProposal(o),class:"p-1.5 text-gray-600 hover:text-brand-600 dark:text-gray-400 dark:hover:text-brand-400",title:"Duplicate"},[...e[18]||(e[18]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])],8,jt),o.status==="draft"?(l(),f(c,{key:2,to:`/proposals/${o.id}/edit`,class:"p-1.5 text-gray-600 hover:text-brand-600 dark:text-gray-400 dark:hover:text-brand-400",title:"Edit"},{default:x(()=>[...e[19]||(e[19]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])]),_:1},8,["to"])):n("v-if",!0),o.status==="draft"?(l(),i("button",{key:3,onClick:p=>r.confirmDelete(o),class:"p-1.5 text-gray-600 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400",title:"Delete"},[...e[20]||(e[20]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Ft)):n("v-if",!0)])])]))),128))])])])],2112))])])]),_:1})}const Lt=E(O,[["render",Dt],["__scopeId","data-v-5a5ca474"],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Proposals/ProposalList.vue"]]);export{Lt as default};
