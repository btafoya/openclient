import{_ as I,b as z,h as v,i as k,H as S,I as F,r as f,q as D,k as j,o,e as t,d,c as s,l as w,t as n,j as _,F as p,g as U,n as L}from"./main-DbkULGVR.js";import{u as B}from"./contacts-VHl-rLxO.js";import{u as E,N as q,a as J}from"./NoteForm-Bgltjv5g.js";import{A as O}from"./AdminLayout-BDc3K8NM.js";import"./index-B9ygI19o.js";import"./clients-TQOw1E9p.js";import"./projects-BdlrFSi1.js";const Y={__name:"ContactView",setup(V,{expose:a}){a();const h=S(),e=F(),g=B(),m=E(),c=f(null),x=f(!1),y=f([]),l=D(()=>g.currentContact);async function C(){var r,i;try{await g.fetchContact(e.params.id),await u()}catch(b){c.value=((i=(r=b.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to load contact"}}async function u(){try{y.value=await m.fetchNotesByContact(e.params.id)}catch(r){console.error("Failed to load notes:",r)}}async function A(){var r,i;if(confirm(`Delete ${l.value.first_name} ${l.value.last_name}?`))try{await g.deleteContact(e.params.id),h.push("/crm/contacts")}catch(b){c.value=((i=(r=b.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to delete contact"}}async function M(r){try{await m.createNote(r),x.value=!1,await u()}catch(i){console.error("Failed to create note:",i)}}async function P(r){alert("Edit note: "+r.id)}async function T(r){try{await m.deleteNote(r.id),await u()}catch(i){console.error("Failed to delete note:",i)}}async function H(r){try{await m.togglePin(r.id),await u()}catch(i){console.error("Failed to toggle pin:",i)}}function R(r){return r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—"}j(()=>C());const N={router:h,route:e,contactStore:g,noteStore:m,error:c,showNoteForm:x,notes:y,contact:l,loadContact:C,loadNotes:u,handleDelete:A,handleCreateNote:M,handleEditNote:P,handleDeleteNote:T,handleTogglePin:H,formatDate:R,ref:f,computed:D,onMounted:j,get useRouter(){return S},get useRoute(){return F},get useContactStore(){return B},get useNoteStore(){return E},AdminLayout:O,NoteCard:J,NoteForm:q};return Object.defineProperty(N,"__isScriptSetup",{enumerable:!1,value:!0}),N}},G={class:"space-y-6"},K={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Q={class:"flex items-center gap-4"},W={class:"text-2xl font-bold text-gray-900 dark:text-white"},X={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Z={key:0},$={key:0,class:"flex items-center gap-2"},tt={key:0,class:"p-8 text-center"},et={class:"rounded-lg bg-red-50 p-4 dark:bg-red-900/20"},at={class:"text-sm text-red-700 dark:text-red-400"},rt={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},ot={class:"lg:col-span-2 space-y-6"},st={class:"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-gray-900"},nt={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},dt={class:"mt-1 text-sm text-gray-900 dark:text-white"},it={class:"mt-1 text-sm text-gray-900 dark:text-white"},lt={class:"mt-1 text-sm text-gray-900 dark:text-white"},ct=["href"],mt={key:1,class:"text-gray-400"},gt={class:"mt-1 text-sm text-gray-900 dark:text-white"},xt=["href"],yt={key:1,class:"text-gray-400"},ut={class:"mt-1 text-sm text-gray-900 dark:text-white"},kt={class:"mt-1 text-sm text-gray-900 dark:text-white"},ft={key:1,class:"text-gray-400"},_t={class:"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-gray-900"},ht={class:"flex items-center justify-between mb-4"},bt={key:0,class:"mb-4"},vt={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},wt={key:2,class:"space-y-3"},pt={class:"space-y-6"},Ct={class:"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-gray-900"},Nt={class:"space-y-3"},St={class:"flex items-center justify-between"},Ft={class:"flex items-center justify-between"},Dt={class:"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-gray-900"},jt={class:"space-y-3"},Lt={class:"mt-1 text-sm text-gray-900 dark:text-white"},Bt={class:"mt-1 text-sm text-gray-900 dark:text-white"};function Et(V,a,h,e,g,m){const c=z("router-link");return o(),v(e.AdminLayout,null,{default:k(()=>{var x,y;return[t("div",G,[d(" Header "),t("div",K,[t("div",Q,[w(c,{to:"/crm/contacts",class:"p-2 text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white"},{default:k(()=>[...a[2]||(a[2]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),_:1}),t("div",null,[t("h1",W,n(e.contact?`${e.contact.first_name} ${e.contact.last_name}`:"Contact Details"),1),t("p",X,[_(n(((x=e.contact)==null?void 0:x.job_title)||"Contact")+" ",1),(y=e.contact)!=null&&y.client_name?(o(),s("span",Z," at "+n(e.contact.client_name),1)):d("v-if",!0)])])]),e.contact?(o(),s("div",$,[w(c,{to:`/crm/contacts/${e.contact.id}/edit`,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700"},{default:k(()=>[...a[3]||(a[3]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),_(" Edit ",-1)])]),_:1},8,["to"]),t("button",{onClick:e.handleDelete,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-red-700 bg-white border border-red-300 rounded-lg hover:bg-red-50 dark:bg-gray-800 dark:text-red-400 dark:border-red-700"},[...a[4]||(a[4]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),_(" Delete ",-1)])])])):d("v-if",!0)]),d(" Loading State "),e.contactStore.loading&&!e.contact?(o(),s("div",tt,[...a[5]||(a[5]=[t("div",{class:"inline-block w-8 h-8 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"Loading contact...",-1)])])):e.error?(o(),s(p,{key:1},[d(" Error State "),t("div",et,[t("p",at,n(e.error),1)])],2112)):e.contact?(o(),s(p,{key:2},[d(" Contact Details "),t("div",rt,[d(" Main Info Card "),t("div",ot,[t("div",st,[a[12]||(a[12]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Contact Information",-1)),t("dl",nt,[t("div",null,[a[6]||(a[6]=t("dt",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"First Name",-1)),t("dd",dt,n(e.contact.first_name),1)]),t("div",null,[a[7]||(a[7]=t("dt",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Last Name",-1)),t("dd",it,n(e.contact.last_name),1)]),t("div",null,[a[8]||(a[8]=t("dt",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Email",-1)),t("dd",lt,[e.contact.email?(o(),s("a",{key:0,href:`mailto:${e.contact.email}`,class:"text-brand-600 hover:underline"},n(e.contact.email),9,ct)):(o(),s("span",mt,"—"))])]),t("div",null,[a[9]||(a[9]=t("dt",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Phone",-1)),t("dd",gt,[e.contact.phone?(o(),s("a",{key:0,href:`tel:${e.contact.phone}`,class:"text-brand-600 hover:underline"},n(e.contact.phone),9,xt)):(o(),s("span",yt,"—"))])]),t("div",null,[a[10]||(a[10]=t("dt",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Job Title",-1)),t("dd",ut,n(e.contact.job_title||"—"),1)]),t("div",null,[a[11]||(a[11]=t("dt",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Client",-1)),t("dd",kt,[e.contact.client_id?(o(),v(c,{key:0,to:`/crm/clients/${e.contact.client_id}`,class:"text-brand-600 hover:underline"},{default:k(()=>[_(n(e.contact.client_name),1)]),_:1},8,["to"])):(o(),s("span",ft,"—"))])])])]),d(" Notes Section "),t("div",_t,[t("div",ht,[a[13]||(a[13]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Notes",-1)),t("button",{onClick:a[0]||(a[0]=l=>e.showNoteForm=!0),class:"text-sm text-brand-600 hover:text-brand-700"}," + Add Note ")]),e.showNoteForm?(o(),s("div",bt,[w(e.NoteForm,{"initial-data":{contact_id:e.contact.id,client_id:e.contact.client_id},onSubmit:e.handleCreateNote,onCancel:a[1]||(a[1]=l=>e.showNoteForm=!1)},null,8,["initial-data"])])):d("v-if",!0),e.notes.length===0&&!e.showNoteForm?(o(),s("div",vt,[...a[14]||(a[14]=[t("p",null,"No notes yet",-1)])])):(o(),s("div",wt,[(o(!0),s(p,null,U(e.notes,l=>(o(),v(e.NoteCard,{key:l.id,note:l,onEdit:e.handleEditNote,onDelete:e.handleDeleteNote,onTogglePin:e.handleTogglePin},null,8,["note"]))),128))]))])]),d(" Sidebar "),t("div",pt,[d(" Status Card "),t("div",Ct,[a[17]||(a[17]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Status",-1)),t("div",Nt,[t("div",St,[a[15]||(a[15]=t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Primary Contact",-1)),t("span",{class:L([e.contact.is_primary?"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400","inline-flex items-center px-2.5 py-0.5 text-xs font-medium rounded-full"])},n(e.contact.is_primary?"Yes":"No"),3)]),t("div",Ft,[a[16]||(a[16]=t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Status",-1)),t("span",{class:L([e.contact.is_active?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400","inline-flex items-center px-2.5 py-0.5 text-xs font-medium rounded-full"])},n(e.contact.is_active?"Active":"Inactive"),3)])])]),d(" Timestamps Card "),t("div",Dt,[a[20]||(a[20]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Activity",-1)),t("dl",jt,[t("div",null,[a[18]||(a[18]=t("dt",{class:"text-sm text-gray-500 dark:text-gray-400"},"Created",-1)),t("dd",Lt,n(e.formatDate(e.contact.created_at)),1)]),t("div",null,[a[19]||(a[19]=t("dt",{class:"text-sm text-gray-500 dark:text-gray-400"},"Last Updated",-1)),t("dd",Bt,n(e.formatDate(e.contact.updated_at)),1)])])])])])],2112)):d("v-if",!0)])]}),_:1})}const It=I(Y,[["render",Et],["__file","/home/btafoya/projects/openclient/resources/js/src/views/CRM/Contacts/ContactView.vue"]]);export{It as default};
