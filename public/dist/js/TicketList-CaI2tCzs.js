import{_ as N,b as H,h as w,i as g,r as y,q as _,k as T,o as a,e as t,d as i,c as n,l as h,j as m,t as c,w as v,v as I,z as C,F as f,g as U,n as S}from"./main-Dc7XXzbq.js";import{u as F}from"./tickets-BtA3sVWy.js";import{A as R}from"./AdminLayout-DxqTGoZO.js";import"./index-B9ygI19o.js";const E={__name:"TicketList",setup(j,{expose:e}){e();const l=F(),r=y(""),k=y("all"),p=y("all"),x=_(()=>{let s=l.filteredTickets;return k.value!=="all"&&(s=s.filter(d=>d.status===k.value)),p.value!=="all"&&(s=s.filter(d=>d.priority===p.value)),s});async function o(){try{await Promise.all([l.fetchTickets(),l.fetchStats()])}catch(s){console.error("Failed to load tickets:",s)}}function u(){l.setSearchTerm(r.value)}function M(){l.setStatusFilter(k.value),l.setPriorityFilter(p.value)}async function B(s){try{await l.updateTicket(s.id,{status:"in_progress"}),await o()}catch(d){console.error("Failed to update ticket:",d),alert("Failed to update ticket status.")}}async function L(s){if(confirm(`Mark ticket ${s.ticket_number} as resolved?`))try{await l.resolveTicket(s.id),await o()}catch(d){console.error("Failed to resolve ticket:",d),alert("Failed to resolve ticket.")}}async function z(s){if(confirm(`Close ticket ${s.ticket_number}?`))try{await l.closeTicket(s.id),await o()}catch(d){console.error("Failed to close ticket:",d),alert("Failed to close ticket.")}}async function A(s){if(confirm(`Reopen ticket ${s.ticket_number}?`))try{await l.reopenTicket(s.id),await o()}catch(d){console.error("Failed to reopen ticket:",d),alert("Failed to reopen ticket.")}}async function P(s){if(confirm(`Are you sure you want to delete ticket ${s.ticket_number}? This action cannot be undone.`))try{await l.deleteTicket(s.id)}catch(d){console.error("Failed to delete ticket:",d),alert("Failed to delete ticket.")}}function V(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"â€”"}function D(s){return(s==null?void 0:s.replace("_"," "))||s}T(()=>{o()});const b={ticketStore:l,searchTerm:r,statusFilter:k,priorityFilter:p,displayedTickets:x,loadTickets:o,handleSearch:u,applyFilter:M,markInProgress:B,resolveTicket:L,closeTicket:z,reopenTicket:A,confirmDelete:P,formatDate:V,formatStatus:D,ref:y,computed:_,onMounted:T,get useTicketStore(){return F},AdminLayout:R};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}},O={class:"space-y-6"},q={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},W={key:0,class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Y={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},G={class:"mt-1 text-2xl font-bold text-blue-600"},J={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},K={class:"mt-1 text-2xl font-bold text-yellow-600"},Q={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},X={class:"mt-1 text-2xl font-bold text-green-600"},Z={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},$={class:"mt-1 text-2xl font-bold text-red-600"},tt={class:"flex flex-col gap-4 sm:flex-row sm:items-center"},et={class:"flex-1"},rt={class:"relative"},ot={class:"flex gap-3"},st={class:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"},at={key:0,class:"p-8 text-center"},it={class:"p-8 text-center"},nt={class:"mt-4 text-sm text-gray-900 dark:text-white font-medium"},lt={class:"p-8 text-center"},dt={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},ct={class:"max-w-full overflow-x-auto custom-scrollbar"},xt={class:"min-w-full"},ut={class:"divide-y divide-gray-200 dark:divide-gray-700"},kt={class:"px-5 py-4 sm:px-6"},pt={class:"text-gray-500 text-theme-xs dark:text-gray-400 mt-0.5 truncate max-w-xs"},gt={class:"px-5 py-4 sm:px-6"},yt={class:"px-5 py-4 sm:px-6"},mt={class:"px-5 py-4 sm:px-6"},ft={class:"text-theme-sm"},ht={key:0,class:"text-gray-700 dark:text-gray-300"},vt={key:1,class:"text-gray-400 dark:text-gray-500 italic"},bt={class:"px-5 py-4 sm:px-6"},wt={class:"text-theme-sm text-gray-600 dark:text-gray-400"},_t={class:"px-5 py-4 sm:px-6"},Tt={class:"flex items-center justify-end gap-2"},Ct=["onClick"],St=["onClick"],Ft=["onClick"],jt=["onClick"],Mt=["onClick"];function Bt(j,e,l,r,k,p){const x=H("router-link");return a(),w(r.AdminLayout,null,{default:g(()=>[t("div",O,[i(" Page Header "),t("div",q,[e[4]||(e[4]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Support Tickets"),t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Manage client support requests and issues ")],-1)),h(x,{to:"/tickets/create",class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700"},{default:g(()=>[...e[3]||(e[3]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),m(" New Ticket ",-1)])]),_:1})]),i(" Stats Cards "),r.ticketStore.stats?(a(),n("div",W,[t("div",Y,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Open Tickets",-1)),t("p",G,c(r.ticketStore.stats.open_count||0),1)]),t("div",J,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"In Progress",-1)),t("p",K,c(r.ticketStore.stats.in_progress_count||0),1)]),t("div",Q,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Resolved",-1)),t("p",X,c(r.ticketStore.stats.resolved_count||0),1)]),t("div",Z,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Urgent",-1)),t("p",$,c(r.ticketStore.stats.urgent_count||0),1)])])):i("v-if",!0),i(" Search and Filters "),t("div",tt,[t("div",et,[t("div",rt,[v(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.searchTerm=o),type:"text",placeholder:"Search tickets by number, subject, or description...",class:"w-full px-4 py-2 pl-10 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",onInput:r.handleSearch},null,544),[[I,r.searchTerm]]),e[9]||(e[9]=t("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),t("div",ot,[v(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.statusFilter=o),onChange:r.applyFilter,class:"px-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},[...e[10]||(e[10]=[t("option",{value:"all"},"All Statuses",-1),t("option",{value:"open"},"Open",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"waiting"},"Waiting",-1),t("option",{value:"resolved"},"Resolved",-1),t("option",{value:"closed"},"Closed",-1)])],544),[[C,r.statusFilter]]),v(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.priorityFilter=o),onChange:r.applyFilter,class:"px-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},[...e[11]||(e[11]=[t("option",{value:"all"},"All Priorities",-1),t("option",{value:"urgent"},"Urgent",-1),t("option",{value:"high"},"High",-1),t("option",{value:"normal"},"Normal",-1),t("option",{value:"low"},"Low",-1)])],544),[[C,r.priorityFilter]])])]),i(" Tickets Table "),t("div",st,[i(" Loading State "),r.ticketStore.loading?(a(),n("div",at,[...e[12]||(e[12]=[t("div",{class:"inline-block w-8 h-8 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"Loading tickets...",-1)])])):r.ticketStore.error?(a(),n(f,{key:1},[i(" Error State "),t("div",it,[e[13]||(e[13]=t("div",{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/20"},[t("svg",{class:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),t("p",nt,c(r.ticketStore.error),1),t("button",{onClick:r.loadTickets,class:"mt-4 px-4 py-2 text-sm font-medium text-brand-600 hover:text-brand-700"}," Try Again ")])],2112)):r.displayedTickets.length===0?(a(),n(f,{key:2},[i(" Empty State "),t("div",lt,[e[15]||(e[15]=t("div",{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 dark:bg-gray-800"},[t("svg",{class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})])],-1)),e[16]||(e[16]=t("p",{class:"mt-4 text-sm text-gray-900 dark:text-white font-medium"},"No tickets found",-1)),t("p",dt,c(r.searchTerm?"Try adjusting your search":"No support tickets yet"),1),r.searchTerm?i("v-if",!0):(a(),w(x,{key:0,to:"/tickets/create",class:"inline-flex items-center gap-2 mt-4 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700"},{default:g(()=>[...e[14]||(e[14]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),m(" Create Your First Ticket ",-1)])]),_:1}))])],2112)):(a(),n(f,{key:3},[i(" Table Content "),t("div",ct,[t("table",xt,[e[24]||(e[24]=t("thead",null,[t("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[t("th",{class:"px-5 py-3 text-left sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Ticket")]),t("th",{class:"px-5 py-3 text-left sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Status")]),t("th",{class:"px-5 py-3 text-left sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Priority")]),t("th",{class:"px-5 py-3 text-left sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Client")]),t("th",{class:"px-5 py-3 text-left sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Created")]),t("th",{class:"px-5 py-3 text-right sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Actions")])])],-1)),t("tbody",ut,[(a(!0),n(f,null,U(r.displayedTickets,o=>(a(),n("tr",{key:o.id,class:"border-t border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800/50"},[t("td",kt,[t("div",null,[h(x,{to:`/tickets/${o.id}`,class:"block font-medium text-gray-800 text-theme-sm dark:text-white/90 hover:text-brand-600 dark:hover:text-brand-400"},{default:g(()=>[m(c(o.ticket_number),1)]),_:2},1032,["to"]),t("p",pt,c(o.subject),1)])]),t("td",gt,[t("span",{class:S(["inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-full capitalize",r.ticketStore.getStatusColor(o.status)])},[e[17]||(e[17]=t("span",{class:"w-1.5 h-1.5 rounded-full bg-current opacity-70"},null,-1)),m(" "+c(r.formatStatus(o.status)),1)],2)]),t("td",yt,[t("span",{class:S(["inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-full capitalize",r.ticketStore.getPriorityColor(o.priority)])},c(o.priority),3)]),t("td",mt,[t("div",ft,[o.client_name?(a(),n("p",ht,c(o.client_name),1)):(a(),n("p",vt," No client "))])]),t("td",bt,[t("span",wt,c(r.formatDate(o.created_at)),1)]),t("td",_t,[t("div",Tt,[h(x,{to:`/tickets/${o.id}`,class:"p-1.5 text-gray-600 hover:text-brand-600 dark:text-gray-400 dark:hover:text-brand-400",title:"View Ticket"},{default:g(()=>[...e[18]||(e[18]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])]),_:1},8,["to"]),o.status==="open"?(a(),n("button",{key:0,onClick:u=>r.markInProgress(o),class:"p-1.5 text-gray-600 hover:text-yellow-600 dark:text-gray-400 dark:hover:text-yellow-400",title:"Start Working"},[...e[19]||(e[19]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],8,Ct)):i("v-if",!0),["open","in_progress","waiting"].includes(o.status)?(a(),n("button",{key:1,onClick:u=>r.resolveTicket(o),class:"p-1.5 text-gray-600 hover:text-green-600 dark:text-gray-400 dark:hover:text-green-400",title:"Resolve Ticket"},[...e[20]||(e[20]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],8,St)):i("v-if",!0),o.status==="resolved"?(a(),n("button",{key:2,onClick:u=>r.closeTicket(o),class:"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200",title:"Close Ticket"},[...e[21]||(e[21]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)])],8,Ft)):i("v-if",!0),o.status==="closed"?(a(),n("button",{key:3,onClick:u=>r.reopenTicket(o),class:"p-1.5 text-gray-600 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400",title:"Reopen Ticket"},[...e[22]||(e[22]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])],8,jt)):i("v-if",!0),o.status==="open"?(a(),n("button",{key:4,onClick:u=>r.confirmDelete(o),class:"p-1.5 text-gray-600 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400",title:"Delete Ticket"},[...e[23]||(e[23]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Mt)):i("v-if",!0)])])]))),128))])])])],2112))])])]),_:1})}const Vt=N(E,[["render",Bt],["__scopeId","data-v-c01aff3b"],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Tickets/TicketList.vue"]]);export{Vt as default};
