import{_ as z,b as G,h as J,i as I,H as A,r as k,q as b,k as U,o as u,e,d as a,l as q,C as K,c as g,w as d,j as f,F as S,g as j,t as m,z as P,v as i}from"./main-Dc7XXzbq.js";import{a as W}from"./index-B9ygI19o.js";import{u as L}from"./invoices-C0QBjOwK.js";import{u as T}from"./clients-DtdxGGMB.js";import{u as B}from"./projects-edQePXn1.js";import{A as X}from"./AdminLayout-DxqTGoZO.js";const Y={__name:"InvoiceCreate",setup(M,{expose:t}){t();const w=A(),r=L(),p=T(),x=B(),c=k(!1),o=k(null),s=k({client_id:"",project_id:"",invoice_date:new Date().toISOString().split("T")[0],due_date:new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],discount:0,tax_rate:0,notes:"",terms:"Payment is due within 30 days of invoice date.",line_items:[{description:"",quantity:1,rate:0}]}),l=b(()=>p.activeClients),N=b(()=>s.value.client_id?x.projects.filter(n=>n.client_id===s.value.client_id):x.activeProjects),v=b(()=>s.value.line_items.reduce((n,y)=>n+y.quantity*y.rate,0)),_=b(()=>(v.value-(s.value.discount||0))*((s.value.tax_rate||0)/100)),V=b(()=>v.value-(s.value.discount||0)+_.value);function F(){s.value.line_items.push({description:"",quantity:1,rate:0})}function R(n){s.value.line_items.length>1&&s.value.line_items.splice(n,1)}async function H(){var n,y;c.value=!0,o.value=null;try{const h=s.value.line_items.map(C=>({...C,amount:C.quantity*C.rate})),E={...s.value,line_items:h,subtotal:v.value,tax:_.value,total:V.value},Q=await r.createInvoice(E);w.push(`/invoices/${Q.id}`)}catch(h){o.value=((y=(n=h.response)==null?void 0:n.data)==null?void 0:y.error)||"Failed to create invoice"}finally{c.value=!1}}function O(n){return Number(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}U(async()=>{try{await Promise.all([p.fetchClients(),x.fetchProjects()])}catch(n){console.error("Failed to load data:",n)}});const D={router:w,invoiceStore:r,clientStore:p,projectStore:x,saving:c,error:o,form:s,clients:l,filteredProjects:N,subtotal:v,taxAmount:_,total:V,addLineItem:F,removeLineItem:R,createInvoice:H,formatCurrency:O,ref:k,computed:b,onMounted:U,get useRouter(){return A},get axios(){return W},get useInvoiceStore(){return L},get useClientStore(){return T},get useProjectStore(){return B},AdminLayout:X};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}},Z={class:"space-y-6"},$={class:"flex items-center gap-3"},ee={class:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] p-6"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},re=["value"],oe=["value"],ae={class:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] p-6"},se={class:"space-y-4"},ne={class:"col-span-12 sm:col-span-5"},de=["onUpdate:modelValue"],ie={class:"col-span-4 sm:col-span-2"},le=["onUpdate:modelValue"],ue={class:"col-span-4 sm:col-span-2"},me=["onUpdate:modelValue"],ge={class:"col-span-3 sm:col-span-2"},ce={class:"px-3 py-2 text-sm font-medium text-gray-900 dark:text-white"},be={class:"col-span-1 flex items-end"},xe=["onClick","disabled"],ye={class:"mt-6 flex flex-col items-end space-y-3"},fe={class:"flex items-center gap-4 w-72"},pe={class:"ml-auto font-medium text-gray-900 dark:text-white"},ve={class:"flex items-center gap-4 w-72"},ke={class:"ml-auto flex items-center gap-2"},we={class:"flex items-center gap-4 w-72"},_e={class:"ml-auto flex items-center gap-2"},he={class:"flex items-center gap-4 w-72"},Ce={class:"ml-auto font-medium text-gray-900 dark:text-white"},Ie={class:"flex items-center gap-4 w-72 pt-3 border-t border-gray-200 dark:border-gray-700"},Se={class:"ml-auto text-lg font-bold text-gray-900 dark:text-white"},je={class:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] p-6"},Ve={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},De={key:0,class:"p-4 rounded-lg bg-red-50 dark:bg-red-900/20"},Ae={class:"text-sm text-red-700 dark:text-red-400"},Ue={class:"flex items-center justify-end gap-4"},qe=["disabled"];function Pe(M,t,w,r,p,x){const c=G("router-link");return u(),J(r.AdminLayout,null,{default:I(()=>[e("div",Z,[a(" Page Header "),e("div",$,[q(c,{to:"/invoices",class:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"},{default:I(()=>[...t[8]||(t[8]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1}),t[9]||(t[9]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Create Invoice"),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Create a new invoice for a client ")],-1))]),a(" Invoice Form "),e("form",{onSubmit:K(r.createInvoice,["prevent"]),class:"space-y-6"},[a(" Basic Info "),e("div",ee,[t[16]||(t[16]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Invoice Details",-1)),e("div",te,[a(" Client "),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[f(" Client "),e("span",{class:"text-red-500"},"*")],-1)),d(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>r.form.client_id=o),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},[t[10]||(t[10]=e("option",{value:""},"Select a client...",-1)),(u(!0),g(S,null,j(r.clients,o=>(u(),g("option",{key:o.id,value:o.id},m(o.name),9,re))),128))],512),[[P,r.form.client_id]])]),a(" Project "),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Project (Optional) ",-1)),d(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.form.project_id=o),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},[t[12]||(t[12]=e("option",{value:""},"No project",-1)),(u(!0),g(S,null,j(r.filteredProjects,o=>(u(),g("option",{key:o.id,value:o.id},m(o.name),9,oe))),128))],512),[[P,r.form.project_id]])]),a(" Invoice Date "),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[f(" Invoice Date "),e("span",{class:"text-red-500"},"*")],-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.form.invoice_date=o),type:"date",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},null,512),[[i,r.form.invoice_date]])]),a(" Due Date "),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[f(" Due Date "),e("span",{class:"text-red-500"},"*")],-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>r.form.due_date=o),type:"date",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},null,512),[[i,r.form.due_date]])])])]),a(" Line Items "),e("div",ae,[e("div",{class:"flex items-center justify-between mb-4"},[t[18]||(t[18]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Line Items",-1)),e("button",{type:"button",onClick:r.addLineItem,class:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-brand-600 hover:text-brand-700"},[...t[17]||(t[17]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),f(" Add Item ",-1)])])]),e("div",se,[(u(!0),g(S,null,j(r.form.line_items,(o,s)=>(u(),g("div",{key:s,class:"grid grid-cols-12 gap-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},[a(" Description "),e("div",ne,[t[19]||(t[19]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"},"Description",-1)),d(e("input",{"onUpdate:modelValue":l=>o.description=l,type:"text",required:"",placeholder:"Service or product description",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},null,8,de),[[i,o.description]])]),a(" Quantity "),e("div",ie,[t[20]||(t[20]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"},"Qty",-1)),d(e("input",{"onUpdate:modelValue":l=>o.quantity=l,type:"number",min:"0.01",step:"0.01",required:"",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},null,8,le),[[i,o.quantity,void 0,{number:!0}]])]),a(" Rate "),e("div",ue,[t[21]||(t[21]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"},"Rate ($)",-1)),d(e("input",{"onUpdate:modelValue":l=>o.rate=l,type:"number",min:"0",step:"0.01",required:"",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},null,8,me),[[i,o.rate,void 0,{number:!0}]])]),a(" Amount "),e("div",ge,[t[22]||(t[22]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"},"Amount",-1)),e("p",ce," $"+m(r.formatCurrency(o.quantity*o.rate)),1)]),a(" Remove Button "),e("div",be,[e("button",{type:"button",onClick:l=>r.removeLineItem(s),disabled:r.form.line_items.length===1,class:"p-2 text-gray-400 hover:text-red-600 disabled:opacity-50 disabled:cursor-not-allowed"},[...t[23]||(t[23]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,xe)])]))),128))]),a(" Totals "),e("div",ye,[e("div",fe,[t[24]||(t[24]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Subtotal",-1)),e("span",pe,"$"+m(r.formatCurrency(r.subtotal)),1)]),e("div",ve,[t[26]||(t[26]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Discount",-1)),e("div",ke,[t[25]||(t[25]=e("span",{class:"text-gray-500"},"$",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>r.form.discount=o),type:"number",min:"0",step:"0.01",class:"w-24 px-2 py-1 text-sm text-right border border-gray-300 rounded focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},null,512),[[i,r.form.discount,void 0,{number:!0}]])])]),e("div",we,[t[28]||(t[28]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Tax Rate",-1)),e("div",_e,[d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>r.form.tax_rate=o),type:"number",min:"0",max:"100",step:"0.01",class:"w-20 px-2 py-1 text-sm text-right border border-gray-300 rounded focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},null,512),[[i,r.form.tax_rate,void 0,{number:!0}]]),t[27]||(t[27]=e("span",{class:"text-gray-500"},"%",-1))])]),e("div",he,[t[29]||(t[29]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Tax Amount",-1)),e("span",Ce,"$"+m(r.formatCurrency(r.taxAmount)),1)]),e("div",Ie,[t[30]||(t[30]=e("span",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Total",-1)),e("span",Se,"$"+m(r.formatCurrency(r.total)),1)])])]),a(" Notes & Terms "),e("div",je,[t[33]||(t[33]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Additional Information",-1)),e("div",Ve,[a(" Notes "),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Notes (visible to client) ",-1)),d(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=o=>r.form.notes=o),rows:"4",placeholder:"Additional notes or instructions...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},null,512),[[i,r.form.notes]])]),a(" Terms "),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Terms & Conditions ",-1)),d(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=o=>r.form.terms=o),rows:"4",placeholder:"Payment terms, late fees, etc...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},null,512),[[i,r.form.terms]])])])]),a(" Error Message "),r.error?(u(),g("div",De,[e("p",Ae,m(r.error),1)])):a("v-if",!0),a(" Form Actions "),e("div",Ue,[q(c,{to:"/invoices",class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600"},{default:I(()=>[...t[34]||(t[34]=[f(" Cancel ",-1)])]),_:1}),e("button",{type:"submit",disabled:r.saving,class:"px-6 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed"},m(r.saving?"Creating...":"Create Invoice"),9,qe)])],32)])]),_:1})}const Re=z(Y,[["render",Pe],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Invoices/InvoiceCreate.vue"]]);export{Re as default};
