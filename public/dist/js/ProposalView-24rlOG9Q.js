import{_ as U,b as z,c as s,l as v,d,e as t,F as m,t as a,n as A,j as k,i as D,g as _,I as V,H as j,r as u,q as w,k as I,o as n}from"./main-DU5QQqOg.js";import{u as T}from"./proposals-CGDc7SOs.js";import{P as H}from"./PageBreadcrumb-Bc2RP6vt.js";import"./index-B9ygI19o.js";const E={__name:"ProposalView",setup(B,{expose:r}){r();const f=V(),e=j(),c=T(),h=u(!0),x=u(!1),p=u(!1),y=u(!1),l=u(null),i=w(()=>{var b;const o={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",viewed:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",rejected:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300",expired:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300"};return o[(b=l.value)==null?void 0:b.status]||o.draft}),g=w(()=>{var o,b,P,S;return((b=(o=l.value)==null?void 0:o.status)==null?void 0:b.charAt(0).toUpperCase())+((S=(P=l.value)==null?void 0:P.status)==null?void 0:S.slice(1))||"Draft"});function F(o){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(o||0)}function L(o){return o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}function N(o){return o?new Date(o).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}async function R(){x.value=!0;try{await c.sendProposal(l.value.id),l.value.status="sent",l.value.sent_at=new Date().toISOString()}catch(o){console.error("Failed to send proposal:",o)}finally{x.value=!1}}async function q(){p.value=!0;try{const o=await c.convertToInvoice(l.value.id);e.push(`/invoices/${o.id}`)}catch(o){console.error("Failed to convert to invoice:",o)}finally{p.value=!1}}async function M(){y.value=!0;try{await c.downloadPdf(l.value.id)}catch(o){console.error("Failed to download PDF:",o)}finally{y.value=!1}}I(async()=>{try{l.value=await c.fetchProposal(f.params.id)}catch(o){console.error("Failed to load proposal:",o)}finally{h.value=!1}});const C={route:f,router:e,proposalStore:c,loading:h,sending:x,converting:p,downloading:y,proposal:l,statusClass:i,statusLabel:g,formatCurrency:F,formatDate:L,formatDateTime:N,sendProposal:R,convertToInvoice:q,downloadPdf:M,ref:u,computed:w,onMounted:I,get useRoute(){return V},get useRouter(){return j},get useProposalStore(){return T},PageBreadcrumb:H};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}},O={key:0,class:"flex items-center justify-center py-12"},Q={class:"space-y-6"},G={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},J={class:"text-2xl font-bold text-gray-900 dark:text-white"},K={class:"text-gray-500 dark:text-gray-400 mt-1"},W={class:"flex items-center gap-3"},X={class:"flex items-center gap-2"},Y=["disabled"],Z=["disabled"],$=["disabled"],tt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},et={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},rt={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},ot={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},at={class:"text-lg font-semibold text-gray-900 dark:text-white mt-1"},st={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},dt={class:"text-lg font-semibold text-gray-900 dark:text-white mt-1"},nt={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},lt={class:"text-lg font-semibold text-gray-900 dark:text-white mt-1"},it={key:0,class:"bg-green-50 dark:bg-green-900/20 rounded-xl border border-green-200 dark:border-green-800 p-4"},gt={class:"flex items-center gap-3"},ct={class:"flex-1"},xt={class:"text-sm font-medium text-green-800 dark:text-green-200"},pt={class:"text-xs text-green-600 dark:text-green-400 mt-1"},yt={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},ut={class:"divide-y divide-gray-200 dark:divide-gray-700"},bt={class:"text-md font-medium text-gray-900 dark:text-white mb-3"},mt={class:"prose dark:prose-invert max-w-none text-gray-600 dark:text-gray-300 whitespace-pre-wrap"},kt={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},ft={class:"overflow-x-auto"},ht={class:"w-full"},vt={class:"divide-y divide-gray-200 dark:divide-gray-700"},_t={class:"px-6 py-4 text-gray-900 dark:text-white"},wt={class:"px-6 py-4 text-right text-gray-900 dark:text-white"},Ct={class:"px-6 py-4 text-right text-gray-900 dark:text-white"},Pt={class:"px-6 py-4 text-right font-medium text-gray-900 dark:text-white"},St={class:"bg-gray-50 dark:bg-gray-900/50"},Dt={class:"px-6 py-4 text-right text-xl font-bold text-gray-900 dark:text-white"},Vt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},jt={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},It={class:"text-gray-600 dark:text-gray-300 whitespace-pre-wrap"},Tt={key:1,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},Bt={class:"text-gray-600 dark:text-gray-300 whitespace-pre-wrap"},Ft={key:1,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},Lt={class:"space-y-4"},Nt={class:"text-sm text-gray-900 dark:text-white"},Rt={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},qt={class:"text-center py-12"};function Mt(B,r,f,e,c,h){var p,y,l;const x=z("router-link");return n(),s("div",null,[v(e.PageBreadcrumb,{pageTitle:"Proposal Details"}),d(" Loading State "),e.loading?(n(),s("div",O,[...r[0]||(r[0]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-500"},null,-1)])])):e.proposal?(n(),s(m,{key:1},[d(" Proposal Content "),t("div",Q,[d(" Header with Actions "),t("div",G,[t("div",null,[t("h2",J,a(e.proposal.title),1),t("p",K,a(((p=e.proposal.client)==null?void 0:p.company_name)||((y=e.proposal.client)==null?void 0:y.name))+" â€¢ Proposal #"+a(e.proposal.proposal_number),1)]),t("div",W,[t("span",{class:A(["px-3 py-1 rounded-full text-sm font-medium",e.statusClass])},a(e.statusLabel),3),t("div",X,[e.proposal.status==="draft"?(n(),s("button",{key:0,onClick:e.sendProposal,disabled:e.sending,class:"px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50 flex items-center gap-2"},[...r[1]||(r[1]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1),k(" Send to Client ",-1)])],8,Y)):d("v-if",!0),e.proposal.status==="accepted"?(n(),s("button",{key:1,onClick:e.convertToInvoice,disabled:e.converting,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center gap-2"},[...r[2]||(r[2]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),k(" Convert to Invoice ",-1)])],8,Z)):d("v-if",!0),v(x,{to:`/proposals/${e.proposal.id}/edit`,class:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700"},{default:D(()=>[...r[3]||(r[3]=[k(" Edit ",-1)])]),_:1},8,["to"]),t("button",{onClick:e.downloadPdf,disabled:e.downloading,class:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-2"},[...r[4]||(r[4]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),k(" PDF ",-1)])],8,$)])])]),d(" Info Cards "),t("div",tt,[t("div",et,[r[5]||(r[5]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Total Value",-1)),t("p",rt,a(e.formatCurrency(e.proposal.total)),1)]),t("div",ot,[r[6]||(r[6]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Created",-1)),t("p",at,a(e.formatDate(e.proposal.created_at)),1)]),t("div",st,[r[7]||(r[7]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Valid Until",-1)),t("p",dt,a(e.formatDate(e.proposal.valid_until)),1)]),t("div",nt,[r[8]||(r[8]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"E-Signature",-1)),t("p",lt,a(e.proposal.require_signature?"Required":"Not Required"),1)])]),d(" Signature Info (if signed) "),e.proposal.signed_at?(n(),s("div",it,[t("div",gt,[r[9]||(r[9]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",ct,[t("p",xt," Signed by "+a(e.proposal.signature_name)+" on "+a(e.formatDate(e.proposal.signed_at)),1),t("p",pt," IP: "+a(e.proposal.signature_ip),1)])])])):d("v-if",!0),d(" Content Sections "),t("div",yt,[r[10]||(r[10]=t("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Proposal Content")],-1)),t("div",ut,[(n(!0),s(m,null,_(e.proposal.sections,(i,g)=>(n(),s("div",{key:g,class:"p-6"},[t("h4",bt,a(i.title),1),t("div",mt,a(i.content),1)]))),128))])]),d(" Line Items "),t("div",kt,[r[13]||(r[13]=t("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Pricing")],-1)),t("div",ft,[t("table",ht,[r[12]||(r[12]=t("thead",{class:"bg-gray-50 dark:bg-gray-900/50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Description"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Qty"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Rate"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amount")])],-1)),t("tbody",vt,[(n(!0),s(m,null,_(e.proposal.items,(i,g)=>(n(),s("tr",{key:g},[t("td",_t,a(i.description),1),t("td",wt,a(i.quantity),1),t("td",Ct,a(e.formatCurrency(i.rate)),1),t("td",Pt,a(e.formatCurrency(i.quantity*i.rate)),1)]))),128))]),t("tfoot",St,[t("tr",null,[r[11]||(r[11]=t("td",{colspan:"3",class:"px-6 py-4 text-right font-medium text-gray-900 dark:text-white"},"Total:",-1)),t("td",Dt,a(e.formatCurrency(e.proposal.total)),1)])])])])]),d(" Terms & Notes "),t("div",Vt,[e.proposal.terms?(n(),s("div",jt,[r[14]||(r[14]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-3"},"Terms & Conditions",-1)),t("p",It,a(e.proposal.terms),1)])):d("v-if",!0),e.proposal.notes?(n(),s("div",Tt,[r[15]||(r[15]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-3"},"Notes",-1)),t("p",Bt,a(e.proposal.notes),1)])):d("v-if",!0)]),d(" Activity Log "),(l=e.proposal.activity)!=null&&l.length?(n(),s("div",Ft,[r[17]||(r[17]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Activity",-1)),t("div",Lt,[(n(!0),s(m,null,_(e.proposal.activity,(i,g)=>(n(),s("div",{key:g,class:"flex items-start gap-3"},[r[16]||(r[16]=t("div",{class:"flex-shrink-0 w-2 h-2 mt-2 rounded-full bg-gray-300 dark:bg-gray-600"},null,-1)),t("div",null,[t("p",Nt,a(i.description),1),t("p",Rt,a(e.formatDateTime(i.created_at)),1)])]))),128))])])):d("v-if",!0)])],2112)):(n(),s(m,{key:2},[d(" Not Found "),t("div",qt,[r[19]||(r[19]=t("p",{class:"text-gray-500 dark:text-gray-400"},"Proposal not found.",-1)),v(x,{to:"/proposals",class:"text-brand-600 hover:text-brand-700 mt-2 inline-block"},{default:D(()=>[...r[18]||(r[18]=[k(" Back to Proposals ",-1)])]),_:1})])],2112))])}const Et=U(E,[["render",Mt],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Proposals/ProposalView.vue"]]);export{Et as default};
