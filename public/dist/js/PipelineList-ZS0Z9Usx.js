import{_ as F,b as z,h as P,i as x,H as C,r as S,q as j,k as M,o,e,d as n,c as a,l as L,j as h,w as N,v as A,F as p,t as l,g as B,L as T}from"./main-DU5QQqOg.js";import{u as H}from"./pipelines-W5BYDhct.js";import{A as E}from"./AdminLayout-k0cXXt9e.js";import"./index-B9ygI19o.js";const I={__name:"PipelineList",setup(V,{expose:t}){t();const m=C(),r=H(),y=S(""),k=j(()=>r.filteredPipelines);async function c(){try{await r.fetchPipelines(!0)}catch(d){console.error("Failed to load pipelines:",d)}}function s(){r.setSearchTerm(y.value)}function u(d){m.push(`/deals?pipeline_id=${d.id}`)}async function i(d){var v,b,_,w;if(confirm(`Are you sure you want to delete "${d.name}"? This action cannot be undone.`))try{await r.deletePipeline(d.id)}catch(g){console.error("Failed to delete pipeline:",g),(b=(v=g.response)==null?void 0:v.data)!=null&&b.deal_count?alert(`Cannot delete pipeline: It has ${g.response.data.deal_count} active deals.`):alert(((w=(_=g.response)==null?void 0:_.data)==null?void 0:w.error)||"Failed to delete pipeline. Please try again.")}}function D(d){return Number(d).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}M(()=>{c()});const f={router:m,pipelineStore:r,searchTerm:y,displayedPipelines:k,loadPipelines:c,handleSearch:s,viewPipeline:u,confirmDelete:i,formatCurrency:D,ref:S,computed:j,onMounted:M,get useRouter(){return C},get usePipelineStore(){return H},AdminLayout:E};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}},G={class:"space-y-6"},R={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},U={class:"flex gap-3"},q={class:"flex flex-col gap-4 sm:flex-row sm:items-center"},O={class:"flex-1"},Y={class:"relative"},J={key:0,class:"p-8 text-center"},K={class:"p-8 text-center"},Q={class:"mt-4 text-sm text-gray-900 dark:text-white font-medium"},W={class:"p-8 text-center"},X={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Z={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},$={class:"p-5 border-b border-gray-200 dark:border-gray-800"},ee={class:"flex items-start justify-between"},te={class:"font-semibold text-gray-900 dark:text-white"},re={key:0,class:"mt-1 text-sm text-gray-500 dark:text-gray-400 line-clamp-2"},se={class:"flex items-center gap-1"},oe=["onClick"],ne=["onClick"],ae={class:"p-5"},ie={class:"flex items-center gap-2 mb-3"},le={class:"text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-0.5 rounded"},de={class:"flex flex-wrap gap-2"},ce={key:0,class:"inline-flex items-center px-2 py-1 text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 rounded-full"},pe={class:"px-5 py-3 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-800"},ue={class:"flex items-center justify-between text-sm"},ge={class:"text-gray-500 dark:text-gray-400"},xe={class:"text-gray-900 dark:text-white font-medium"};function me(V,t,m,r,y,k){const c=z("router-link");return o(),P(r.AdminLayout,null,{default:x(()=>[e("div",G,[n(" Page Header "),e("div",R,[t[2]||(t[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Pipelines"),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Manage your sales pipelines and deal stages ")],-1)),e("div",U,[L(c,{to:"/pipelines/create",class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700"},{default:x(()=>[...t[1]||(t[1]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),h(" New Pipeline ",-1)])]),_:1})])]),n(" Search "),e("div",q,[e("div",O,[e("div",Y,[N(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>r.searchTerm=s),type:"text",placeholder:"Search pipelines...",class:"w-full px-4 py-2 pl-10 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",onInput:r.handleSearch},null,544),[[A,r.searchTerm]]),t[3]||(t[3]=e("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])])]),n(" Loading State "),r.pipelineStore.loading?(o(),a("div",J,[...t[4]||(t[4]=[e("div",{class:"inline-block w-8 h-8 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"},null,-1),e("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"Loading pipelines...",-1)])])):r.pipelineStore.error?(o(),a(p,{key:1},[n(" Error State "),e("div",K,[t[5]||(t[5]=e("div",{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/20"},[e("svg",{class:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),e("p",Q,l(r.pipelineStore.error),1),e("button",{onClick:r.loadPipelines,class:"mt-4 px-4 py-2 text-sm font-medium text-brand-600 hover:text-brand-700"}," Try Again ")])],2112)):r.displayedPipelines.length===0?(o(),a(p,{key:2},[n(" Empty State "),e("div",W,[t[7]||(t[7]=e("div",{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 dark:bg-gray-800"},[e("svg",{class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})])],-1)),t[8]||(t[8]=e("p",{class:"mt-4 text-sm text-gray-900 dark:text-white font-medium"},"No pipelines found",-1)),e("p",X,l(r.searchTerm?"Try adjusting your search":"Get started by creating your first pipeline"),1),r.searchTerm?n("v-if",!0):(o(),P(c,{key:0,to:"/pipelines/create",class:"inline-flex items-center gap-2 mt-4 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700"},{default:x(()=>[...t[6]||(t[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),h(" Create Your First Pipeline ",-1)])]),_:1}))])],2112)):(o(),a(p,{key:3},[n(" Pipelines Grid "),e("div",Z,[(o(!0),a(p,null,B(r.displayedPipelines,s=>{var u;return o(),a("div",{key:s.id,class:"bg-white dark:bg-white/[0.03] rounded-xl border border-gray-200 dark:border-gray-800 overflow-hidden"},[n(" Pipeline Header "),e("div",$,[e("div",ee,[e("div",null,[e("h3",te,l(s.name),1),s.description?(o(),a("p",re,l(s.description),1)):n("v-if",!0)]),e("div",se,[e("button",{onClick:i=>r.viewPipeline(s),class:"p-1.5 text-gray-600 hover:text-brand-600 dark:text-gray-400 dark:hover:text-brand-400",title:"View Deals"},[...t[9]||(t[9]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])],8,oe),L(c,{to:`/pipelines/${s.id}/edit`,class:"p-1.5 text-gray-600 hover:text-brand-600 dark:text-gray-400 dark:hover:text-brand-400",title:"Edit Pipeline"},{default:x(()=>[...t[10]||(t[10]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])]),_:1},8,["to"]),e("button",{onClick:i=>r.confirmDelete(s),class:"p-1.5 text-gray-600 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400",title:"Delete Pipeline"},[...t[11]||(t[11]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ne)])])]),n(" Pipeline Stages Preview "),e("div",ae,[e("div",ie,[t[12]||(t[12]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Stages",-1)),e("span",le,l(((u=s.stages)==null?void 0:u.length)||0),1)]),e("div",de,[(o(!0),a(p,null,B((s.stages||[]).slice(0,5),i=>(o(),a("span",{key:i.id,class:"inline-flex items-center gap-1.5 px-2 py-1 text-xs rounded-full",style:T({backgroundColor:i.color+"20",color:i.color})},[e("span",{class:"w-1.5 h-1.5 rounded-full",style:T({backgroundColor:i.color})},null,4),h(" "+l(i.name),1)],4))),128)),(s.stages||[]).length>5?(o(),a("span",ce," +"+l(s.stages.length-5)+" more ",1)):n("v-if",!0)])]),n(" Pipeline Stats "),e("div",pe,[e("div",ue,[e("span",ge,l(s.deal_count||0)+" deals ",1),e("span",xe," $"+l(r.formatCurrency(s.total_value||0)),1)])])])}),128))])],2112))])]),_:1})}const ve=F(I,[["render",me],["__scopeId","data-v-73166e52"],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Pipelines/PipelineList.vue"]]);export{ve as default};
