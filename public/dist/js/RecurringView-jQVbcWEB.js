import{_ as P,b as E,c as d,l as f,d as c,e,F as p,t as s,n as v,j as b,i as w,g as D,I as j,r as k,q as u,k as N,o}from"./main-DU5QQqOg.js";import{u as R}from"./recurringInvoices-DsYqpbgU.js";import{P as U}from"./PageBreadcrumb-Bc2RP6vt.js";import"./index-B9ygI19o.js";const H={__name:"RecurringView",setup(q,{expose:r}){r();const h=j(),t=R(),S=k(!0),_=k(!1),y=k(!1),n=k(null),m=k([]),i=u(()=>{var l;const a={active:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",paused:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300",cancelled:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",expired:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"};return a[(l=n.value)==null?void 0:l.status]||a.active}),C=u(()=>{var a,l,g,x;return((l=(a=n.value)==null?void 0:a.status)==null?void 0:l.charAt(0).toUpperCase())+((x=(g=n.value)==null?void 0:g.status)==null?void 0:x.slice(1))||"Active"}),A=u(()=>{var l,g;return{weekly:"Weekly","bi-weekly":"Every 2 weeks",monthly:"Monthly",quarterly:"Quarterly","semi-annually":"Every 6 months",annually:"Annually"}[(l=n.value)==null?void 0:l.frequency]||((g=n.value)==null?void 0:g.frequency)}),L=u(()=>{var x;const a=(x=n.value)==null?void 0:x.day_of_month;if(!a)return"-";const l=["th","st","nd","rd"],g=a%100;return a+(l[(g-20)%10]||l[g]||l[0])}),B=u(()=>{var l;const a=(l=n.value)==null?void 0:l.payment_terms;return a?a.replace("_"," ").replace(/\b\w/g,g=>g.toUpperCase()):"-"}),V=u(()=>{var a,l;return((l=(a=n.value)==null?void 0:a.items)==null?void 0:l.reduce((g,x)=>g+x.quantity*x.rate,0))||0});function F(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a||0)}function T(a){return a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}async function M(){_.value=!0;try{await t.generateNow(n.value.id),n.value=await t.fetchSchedule(h.params.id),m.value=await t.fetchGeneratedInvoices(h.params.id)}catch(a){console.error("Failed to generate invoice:",a)}finally{_.value=!1}}async function z(){y.value=!0;try{await t.pauseSchedule(n.value.id),n.value.status="paused"}catch(a){console.error("Failed to pause schedule:",a)}finally{y.value=!1}}async function G(){y.value=!0;try{await t.resumeSchedule(n.value.id),n.value.status="active"}catch(a){console.error("Failed to resume schedule:",a)}finally{y.value=!1}}N(async()=>{try{n.value=await t.fetchSchedule(h.params.id),m.value=await t.fetchGeneratedInvoices(h.params.id)}catch(a){console.error("Failed to load schedule:",a)}finally{S.value=!1}});const I={route:h,recurringStore:t,loading:S,generating:_,updating:y,schedule:n,generatedInvoices:m,statusClass:i,statusLabel:C,frequencyLabel:A,ordinalDay:L,paymentTermsLabel:B,subtotal:V,formatCurrency:F,formatDate:T,generateNow:M,pauseSchedule:z,resumeSchedule:G,ref:k,computed:u,onMounted:N,get useRoute(){return j},get useRecurringInvoiceStore(){return R},PageBreadcrumb:U};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}},Q={key:0,class:"flex items-center justify-center py-12"},O={class:"space-y-6"},W={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},J={class:"text-2xl font-bold text-gray-900 dark:text-white"},K={class:"text-gray-500 dark:text-gray-400 mt-1"},X={class:"flex items-center gap-3"},Y={class:"flex items-center gap-2"},Z=["disabled"],$=["disabled"],ee=["disabled"],te={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},re={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},ae={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},se={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},de={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},oe={key:0,class:"text-sm font-normal text-gray-500"},ne={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},le={class:"text-lg font-semibold text-gray-900 dark:text-white mt-1"},ie={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},ce={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ye={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},xe={class:"space-y-3"},ue={class:"flex justify-between"},he={class:"text-gray-900 dark:text-white font-medium"},me={class:"flex justify-between"},be={class:"text-gray-900 dark:text-white font-medium"},ke={class:"flex justify-between"},fe={class:"text-gray-900 dark:text-white font-medium"},_e={class:"flex justify-between"},pe={class:"text-gray-900 dark:text-white font-medium"},ve={class:"flex justify-between"},we={class:"text-gray-900 dark:text-white font-medium"},Se={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},Ce={class:"space-y-3"},Ie={class:"flex items-center gap-3"},De={class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},je={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},Ne={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"},Re={class:"flex items-center gap-3"},qe={class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ae={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},Le={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"},Be={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},Ve={class:"overflow-x-auto"},Fe={class:"w-full"},Te={class:"divide-y divide-gray-200 dark:divide-gray-700"},Me={class:"px-6 py-4 text-gray-900 dark:text-white"},ze={class:"px-6 py-4 text-right text-gray-900 dark:text-white"},Ge={class:"px-6 py-4 text-right text-gray-900 dark:text-white"},Pe={class:"px-6 py-4 text-right font-medium text-gray-900 dark:text-white"},Ee={class:"bg-gray-50 dark:bg-gray-900/50"},Ue={key:0},He={colspan:"3",class:"px-6 py-3 text-right text-gray-600 dark:text-gray-400"},Qe={class:"px-6 py-3 text-right text-gray-900 dark:text-white"},Oe={class:"px-6 py-4 text-right text-xl font-bold text-gray-900 dark:text-white"},We={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},Je={class:"overflow-x-auto"},Ke={class:"w-full"},Xe={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ye={class:"px-6 py-4"},Ze={class:"px-6 py-4 text-gray-900 dark:text-white"},$e={class:"px-6 py-4 text-right text-gray-900 dark:text-white"},et={class:"px-6 py-4 text-center"},tt={class:"px-6 py-4 text-right"},rt={key:1,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},at={class:"text-gray-600 dark:text-gray-300 whitespace-pre-wrap"},st={class:"text-center py-12"};function dt(q,r,h,t,S,_){var n,m;const y=E("router-link");return o(),d("div",null,[f(t.PageBreadcrumb,{pageTitle:"Recurring Schedule Details"}),c(" Loading State "),t.loading?(o(),d("div",Q,[...r[0]||(r[0]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-500"},null,-1)])])):t.schedule?(o(),d(p,{key:1},[c(" Schedule Content "),e("div",O,[c(" Header with Actions "),e("div",W,[e("div",null,[e("h2",J,s(t.schedule.title),1),e("p",K,s(((n=t.schedule.client)==null?void 0:n.company_name)||((m=t.schedule.client)==null?void 0:m.name))+" â€¢ "+s(t.frequencyLabel),1)]),e("div",X,[e("span",{class:v(["px-3 py-1 rounded-full text-sm font-medium",t.statusClass])},s(t.statusLabel),3),e("div",Y,[t.schedule.status==="active"?(o(),d("button",{key:0,onClick:t.generateNow,disabled:t.generating,class:"px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50 flex items-center gap-2"},[...r[1]||(r[1]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),b(" Generate Now ",-1)])],8,Z)):c("v-if",!0),t.schedule.status==="active"?(o(),d("button",{key:1,onClick:t.pauseSchedule,disabled:t.updating,class:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50"}," Pause ",8,$)):c("v-if",!0),t.schedule.status==="paused"?(o(),d("button",{key:2,onClick:t.resumeSchedule,disabled:t.updating,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50"}," Resume ",8,ee)):c("v-if",!0),f(y,{to:`/recurring-invoices/${t.schedule.id}/edit`,class:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700"},{default:w(()=>[...r[2]||(r[2]=[b(" Edit ",-1)])]),_:1},8,["to"])])])]),c(" Info Cards "),e("div",te,[e("div",re,[r[3]||(r[3]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Amount per Invoice",-1)),e("p",ae,s(t.formatCurrency(t.schedule.amount)),1)]),e("div",se,[r[4]||(r[4]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Invoices Generated",-1)),e("p",de,[b(s(t.schedule.invoices_generated)+" ",1),t.schedule.max_invoices?(o(),d("span",oe,"/ "+s(t.schedule.max_invoices),1)):c("v-if",!0)])]),e("div",ne,[r[5]||(r[5]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Next Invoice",-1)),e("p",le,s(t.schedule.next_invoice_date?t.formatDate(t.schedule.next_invoice_date):"N/A"),1)]),e("div",ie,[r[6]||(r[6]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Total Billed",-1)),e("p",ce,s(t.formatCurrency(t.schedule.amount*t.schedule.invoices_generated)),1)])]),c(" Schedule Details "),e("div",ge,[e("div",ye,[r[12]||(r[12]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Schedule Details",-1)),e("dl",xe,[e("div",ue,[r[7]||(r[7]=e("dt",{class:"text-gray-500 dark:text-gray-400"},"Frequency",-1)),e("dd",he,s(t.frequencyLabel),1)]),e("div",me,[r[8]||(r[8]=e("dt",{class:"text-gray-500 dark:text-gray-400"},"Day of Month",-1)),e("dd",be,s(t.ordinalDay),1)]),e("div",ke,[r[9]||(r[9]=e("dt",{class:"text-gray-500 dark:text-gray-400"},"Start Date",-1)),e("dd",fe,s(t.formatDate(t.schedule.start_date)),1)]),e("div",_e,[r[10]||(r[10]=e("dt",{class:"text-gray-500 dark:text-gray-400"},"End Date",-1)),e("dd",pe,s(t.schedule.end_date?t.formatDate(t.schedule.end_date):"No end date"),1)]),e("div",ve,[r[11]||(r[11]=e("dt",{class:"text-gray-500 dark:text-gray-400"},"Payment Terms",-1)),e("dd",we,s(t.paymentTermsLabel),1)])])]),e("div",Se,[r[15]||(r[15]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Settings",-1)),e("div",Ce,[e("div",Ie,[e("span",{class:v(t.schedule.auto_send?"text-green-500":"text-gray-400")},[(o(),d("svg",De,[t.schedule.auto_send?(o(),d("path",je)):(o(),d("path",Ne))]))],2),r[13]||(r[13]=e("span",{class:"text-gray-700 dark:text-gray-300"},"Auto-send to client",-1))]),e("div",Re,[e("span",{class:v(t.schedule.auto_payment?"text-green-500":"text-gray-400")},[(o(),d("svg",qe,[t.schedule.auto_payment?(o(),d("path",Ae)):(o(),d("path",Le))]))],2),r[14]||(r[14]=e("span",{class:"text-gray-700 dark:text-gray-300"},"Auto-charge payment method",-1))])])])]),c(" Line Items "),e("div",Be,[r[18]||(r[18]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Invoice Template")],-1)),e("div",Ve,[e("table",Fe,[r[17]||(r[17]=e("thead",{class:"bg-gray-50 dark:bg-gray-900/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Description"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Qty"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Rate"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amount")])],-1)),e("tbody",Te,[(o(!0),d(p,null,D(t.schedule.items,(i,C)=>(o(),d("tr",{key:C},[e("td",Me,s(i.description),1),e("td",ze,s(i.quantity),1),e("td",Ge,s(t.formatCurrency(i.rate)),1),e("td",Pe,s(t.formatCurrency(i.quantity*i.rate)),1)]))),128))]),e("tfoot",Ee,[t.schedule.tax_rate?(o(),d("tr",Ue,[e("td",He,"Tax ("+s(t.schedule.tax_rate)+"%):",1),e("td",Qe,s(t.formatCurrency(t.subtotal*t.schedule.tax_rate/100)),1)])):c("v-if",!0),e("tr",null,[r[16]||(r[16]=e("td",{colspan:"3",class:"px-6 py-4 text-right font-medium text-gray-900 dark:text-white"},"Total:",-1)),e("td",Oe,s(t.formatCurrency(t.schedule.amount)),1)])])])])]),c(" Generated Invoices "),t.generatedInvoices.length?(o(),d("div",We,[r[21]||(r[21]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Generated Invoices")],-1)),e("div",Je,[e("table",Ke,[r[20]||(r[20]=e("thead",{class:"bg-gray-50 dark:bg-gray-900/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Invoice #"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Date"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amount"),e("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Status"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Actions")])],-1)),e("tbody",Xe,[(o(!0),d(p,null,D(t.generatedInvoices,i=>(o(),d("tr",{key:i.id},[e("td",Ye,[f(y,{to:`/invoices/${i.id}`,class:"text-brand-600 hover:text-brand-700 font-medium"},{default:w(()=>[b(s(i.invoice_number),1)]),_:2},1032,["to"])]),e("td",Ze,s(t.formatDate(i.issue_date)),1),e("td",$e,s(t.formatCurrency(i.total)),1),e("td",et,[e("span",{class:v(["px-2 py-1 rounded-full text-xs font-medium",i.status==="paid"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":i.status==="overdue"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300"])},s(i.status),3)]),e("td",tt,[f(y,{to:`/invoices/${i.id}`,class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},{default:w(()=>[...r[19]||(r[19]=[b(" View ",-1)])]),_:1},8,["to"])])]))),128))])])])])):c("v-if",!0),c(" Notes "),t.schedule.notes?(o(),d("div",rt,[r[22]||(r[22]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-3"},"Notes",-1)),e("p",at,s(t.schedule.notes),1)])):c("v-if",!0)])],2112)):(o(),d(p,{key:2},[c(" Not Found "),e("div",st,[r[24]||(r[24]=e("p",{class:"text-gray-500 dark:text-gray-400"},"Schedule not found.",-1)),f(y,{to:"/recurring-invoices",class:"text-brand-600 hover:text-brand-700 mt-2 inline-block"},{default:w(()=>[...r[23]||(r[23]=[b(" Back to Recurring Invoices ",-1)])]),_:1})])],2112))])}const ct=P(H,[["render",dt],["__file","/home/btafoya/projects/openclient/resources/js/src/views/RecurringInvoices/RecurringView.vue"]]);export{ct as default};
