import{_ as C,c as n,e,d as m,C as P,w as j,v as q,t as f,j as g,F as A,H as k,I as b,r as l,k as v,o as i}from"./main-DU1UAF-x.js";import{u as h}from"./portal-rj4kCz22.js";import"./index-B9ygI19o.js";const L={__name:"PortalLogin",setup(w,{expose:t}){t();const d=k(),r=b(),a=h(),c=l(""),s=l(!1),u=l(""),y=l(!1);async function _(){var o,x;if(c.value){s.value=!0,u.value="";try{await a.requestMagicLink(c.value),y.value=!0}catch(S){u.value=((x=(o=S.response)==null?void 0:o.data)==null?void 0:x.error)||"Failed to send access link. Please try again."}finally{s.value=!1}}}v(async()=>{const o=r.query.token;if(o)try{await a.authenticateWithToken(o),d.push("/portal/dashboard")}catch{u.value="Invalid or expired access link. Please request a new one."}!o&&await a.restoreSession()&&d.push("/portal/dashboard")});const p={router:d,route:r,portalStore:a,email:c,loading:s,error:u,linkSent:y,requestAccess:_,ref:l,onMounted:v,get useRouter(){return k},get useRoute(){return b},get usePortalStore(){return h}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}},M={class:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8"},B={class:"max-w-md w-full space-y-8"},R={key:0,class:"mt-8 space-y-6"},V={class:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8"},E={key:0,class:"text-sm text-red-600 dark:text-red-400"},F=["disabled"],N={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},T={class:"mt-8"},I={class:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8 text-center"},W={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},z={class:"font-medium text-gray-900 dark:text-white"};function D(w,t,d,r,a,c){return i(),n("div",M,[e("div",B,[t[9]||(t[9]=e("div",{class:"text-center"},[e("h2",{class:"mt-6 text-3xl font-extrabold text-gray-900 dark:text-white"}," Client Portal "),e("p",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"}," Access your invoices, proposals, and payment history ")],-1)),m(" Request Access Form "),r.linkSent?(i(),n(A,{key:1},[m(" Link Sent Confirmation "),e("div",T,[e("div",I,[t[6]||(t[6]=e("div",{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/20"},[e("svg",{class:"h-6 w-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),t[7]||(t[7]=e("h3",{class:"mt-4 text-lg font-medium text-gray-900 dark:text-white"}," Check Your Email ",-1)),e("p",W,[t[5]||(t[5]=g(" We've sent a secure access link to ",-1)),e("span",z,f(r.email),1)]),t[8]||(t[8]=e("p",{class:"mt-4 text-xs text-gray-400 dark:text-gray-500"}," The link will expire in 24 hours. If you don't see the email, check your spam folder. ",-1)),e("button",{onClick:t[1]||(t[1]=s=>r.linkSent=!1),class:"mt-6 text-sm font-medium text-brand-600 hover:text-brand-500"}," Use a different email address ")])])],2112)):(i(),n("div",R,[e("div",V,[e("form",{onSubmit:P(r.requestAccess,["prevent"]),class:"space-y-6"},[e("div",null,[t[2]||(t[2]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Email Address ",-1)),j(e("input",{id:"email","onUpdate:modelValue":t[0]||(t[0]=s=>r.email=s),type:"email",required:"",placeholder:"Enter your email address",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white"},null,512),[[q,r.email]])]),r.error?(i(),n("div",E,f(r.error),1)):m("v-if",!0),e("button",{type:"submit",disabled:r.loading,class:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-brand-600 hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 disabled:opacity-50 disabled:cursor-not-allowed"},[r.loading?(i(),n("svg",N,[...t[3]||(t[3]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):m("v-if",!0),g(" "+f(r.loading?"Sending...":"Send Access Link"),1)],8,F)],32),t[4]||(t[4]=e("div",{class:"mt-6 text-center"},[e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},[g(" We'll send you a secure link to access your account. "),e("br"),g("No password needed. ")])],-1))])]))])])}const Y=C(L,[["render",D],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Portal/PortalLogin.vue"]]);export{Y as default};
