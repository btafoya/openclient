import{_ as T,b as V,h as b,i as u,H as w,r as v,q as _,k as S,o as i,e,d as n,c as d,l as x,j as m,t as l,w as C,v as E,z as U,F as y,g as H,n as F}from"./main-Dc7XXzbq.js";import{u as j}from"./recurringInvoices-CzEZok1k.js";import{A as q}from"./AdminLayout-DxqTGoZO.js";import"./index-B9ygI19o.js";const G={__name:"RecurringList",setup(M,{expose:t}){t();const h=w(),r=j(),k=v(""),p=v("all"),c=_(()=>{let s=r.filteredSchedules;return p.value!=="all"&&(s=s.filter(a=>a.status===p.value)),s});async function o(){try{await Promise.all([r.fetchSchedules(),r.fetchUpcoming(7)])}catch(s){console.error("Failed to load schedules:",s)}}function g(){r.setSearchTerm(k.value)}function z(){o()}async function B(s){if(confirm(`Generate invoice now for "${s.title}"?`))try{const a=await r.generateNow(s.id);h.push(`/invoices/${a.id}`)}catch(a){console.error("Failed to generate invoice:",a),alert("Failed to generate invoice. Please try again.")}}async function L(s){if(confirm(`Pause schedule "${s.title}"?`))try{await r.pauseSchedule(s.id)}catch(a){console.error("Failed to pause schedule:",a),alert("Failed to pause schedule. Please try again.")}}async function N(s){try{await r.resumeSchedule(s.id)}catch(a){console.error("Failed to resume schedule:",a),alert("Failed to resume schedule. Please try again.")}}async function A(s){if(confirm(`Cancel schedule "${s.title}"? This cannot be undone.`))try{await r.cancelSchedule(s.id)}catch(a){console.error("Failed to cancel schedule:",a),alert("Failed to cancel schedule. Please try again.")}}function R(s){return Number(s||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function I(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—"}function P(s){const a={active:"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400",paused:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-400",expired:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400",cancelled:"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400"};return a[s]||a.active}function D(s){const a={active:"bg-green-600",paused:"bg-yellow-600",expired:"bg-gray-600",cancelled:"bg-red-600"};return a[s]||a.active}S(()=>{o()});const f={router:h,recurringStore:r,searchTerm:k,statusFilter:p,displayedSchedules:c,loadSchedules:o,handleSearch:g,applyFilter:z,generateNow:B,pauseSchedule:L,resumeSchedule:N,cancelSchedule:A,formatCurrency:R,formatDate:I,getStatusClasses:P,getStatusDotClasses:D,ref:v,computed:_,onMounted:S,get useRouter(){return w},get useRecurringInvoiceStore(){return j},AdminLayout:q};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}},O={class:"space-y-6"},Y={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},J={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},K={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},Q={class:"mt-1 text-2xl font-bold text-green-600"},W={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},X={class:"mt-1 text-2xl font-bold text-yellow-600"},Z={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},$={class:"mt-1 text-2xl font-bold text-gray-600 dark:text-gray-400"},ee={class:"p-4 bg-white rounded-lg border border-gray-200 dark:bg-white/[0.03] dark:border-gray-800"},te={class:"mt-1 text-2xl font-bold text-gray-900 dark:text-white"},re={key:0,class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800"},oe={class:"flex items-start gap-3"},se={class:"text-sm font-medium text-blue-800 dark:text-blue-200"},ae={class:"flex flex-col gap-4 sm:flex-row sm:items-center"},ne={class:"flex-1"},ie={class:"relative"},le={class:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"},de={key:0,class:"p-8 text-center"},ce={class:"p-8 text-center"},ue={class:"text-sm text-gray-900 dark:text-white font-medium"},ge={class:"p-8 text-center"},xe={class:"max-w-full overflow-x-auto custom-scrollbar"},me={class:"min-w-full"},pe={class:"divide-y divide-gray-200 dark:divide-gray-700"},ye={class:"px-5 py-4 sm:px-6"},he={class:"px-5 py-4 sm:px-6"},ke={class:"text-theme-sm text-gray-700 dark:text-gray-300"},ve={class:"px-5 py-4 sm:px-6"},fe={class:"text-theme-sm text-gray-700 dark:text-gray-300 capitalize"},be={class:"px-5 py-4 sm:px-6"},we={class:"text-theme-sm font-medium text-gray-900 dark:text-white"},_e={class:"px-5 py-4 sm:px-6"},Se={class:"text-theme-sm text-gray-600 dark:text-gray-400"},Ce={class:"px-5 py-4 sm:px-6"},Fe={class:"px-5 py-4 sm:px-6"},je={class:"flex items-center justify-end gap-2"},Me=["onClick"],ze=["onClick"],Be=["onClick"],Le=["onClick"];function Ne(M,t,h,r,k,p){const c=V("router-link");return i(),b(r.AdminLayout,null,{default:u(()=>[e("div",O,[n(" Page Header "),e("div",Y,[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Recurring Invoices"),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Automated billing schedules for recurring clients ")],-1)),x(c,{to:"/recurring-invoices/create",class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700"},{default:u(()=>[...t[2]||(t[2]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),m(" New Schedule ",-1)])]),_:1})]),n(" Stats Cards "),e("div",J,[e("div",K,[t[4]||(t[4]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Active Schedules",-1)),e("p",Q,l(r.recurringStore.activeSchedules.length),1)]),e("div",W,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Paused",-1)),e("p",X,l(r.recurringStore.pausedSchedules.length),1)]),e("div",Z,[t[6]||(t[6]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Expired",-1)),e("p",$,l(r.recurringStore.expiredSchedules.length),1)]),e("div",ee,[t[7]||(t[7]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Monthly Revenue",-1)),e("p",te," $"+l(r.formatCurrency(r.recurringStore.monthlyRevenue)),1)])]),n(" Upcoming Invoices Alert "),r.recurringStore.upcomingInvoices.length>0?(i(),d("div",re,[e("div",oe,[t[9]||(t[9]=e("svg",{class:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("div",null,[e("p",se,l(r.recurringStore.upcomingInvoices.length)+" invoice(s) will be generated in the next 7 days ",1),x(c,{to:"/recurring-invoices/upcoming",class:"text-sm text-blue-600 dark:text-blue-400 hover:underline"},{default:u(()=>[...t[8]||(t[8]=[m(" View upcoming invoices → ",-1)])]),_:1})])])])):n("v-if",!0),n(" Search and Filters "),e("div",ae,[e("div",ne,[e("div",ie,[C(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>r.searchTerm=o),type:"text",placeholder:"Search schedules...",class:"w-full px-4 py-2 pl-10 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",onInput:r.handleSearch},null,544),[[E,r.searchTerm]]),t[10]||(t[10]=e("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),C(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.statusFilter=o),onChange:r.applyFilter,class:"px-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white"},[...t[11]||(t[11]=[e("option",{value:"all"},"All Statuses",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"paused"},"Paused",-1),e("option",{value:"expired"},"Expired",-1),e("option",{value:"cancelled"},"Cancelled",-1)])],544),[[U,r.statusFilter]])]),n(" Schedules Table "),e("div",le,[n(" Loading State "),r.recurringStore.loading?(i(),d("div",de,[...t[12]||(t[12]=[e("div",{class:"inline-block w-8 h-8 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"},null,-1),e("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"Loading schedules...",-1)])])):r.recurringStore.error?(i(),d(y,{key:1},[n(" Error State "),e("div",ce,[e("p",ue,l(r.recurringStore.error),1),e("button",{onClick:r.loadSchedules,class:"mt-4 px-4 py-2 text-sm font-medium text-brand-600 hover:text-brand-700"}," Try Again ")])],2112)):r.displayedSchedules.length===0?(i(),d(y,{key:2},[n(" Empty State "),e("div",ge,[t[14]||(t[14]=e("div",{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 dark:bg-gray-800"},[e("svg",{class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t[15]||(t[15]=e("p",{class:"mt-4 text-sm text-gray-900 dark:text-white font-medium"},"No recurring schedules found",-1)),x(c,{to:"/recurring-invoices/create",class:"inline-flex items-center gap-2 mt-4 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700"},{default:u(()=>[...t[13]||(t[13]=[m(" Create Your First Schedule ",-1)])]),_:1})])],2112)):(i(),d(y,{key:3},[n(" Table Content "),e("div",xe,[e("table",me,[t[22]||(t[22]=e("thead",null,[e("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[e("th",{class:"px-5 py-3 text-left sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Schedule")]),e("th",{class:"px-5 py-3 text-left sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Client")]),e("th",{class:"px-5 py-3 text-left sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Frequency")]),e("th",{class:"px-5 py-3 text-left sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Amount")]),e("th",{class:"px-5 py-3 text-left sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Next Invoice")]),e("th",{class:"px-5 py-3 text-left sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Status")]),e("th",{class:"px-5 py-3 text-right sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Actions")])])],-1)),e("tbody",pe,[(i(!0),d(y,null,H(r.displayedSchedules,o=>(i(),d("tr",{key:o.id,class:"border-t border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800/50"},[e("td",ye,[x(c,{to:`/recurring-invoices/${o.id}`,class:"block font-medium text-gray-800 text-theme-sm dark:text-white/90 hover:text-brand-600 dark:hover:text-brand-400"},{default:u(()=>[m(l(o.title),1)]),_:2},1032,["to"])]),e("td",he,[e("p",ke,l(o.client_name||"No client"),1)]),e("td",ve,[e("p",fe,l(r.recurringStore.getFrequencyLabel(o.frequency)),1)]),e("td",be,[e("div",we," $"+l(r.formatCurrency(o.amount)),1)]),e("td",_e,[e("p",Se,l(r.formatDate(o.next_invoice_date)),1)]),e("td",Ce,[e("span",{class:F(["inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-full capitalize",r.getStatusClasses(o.status)])},[e("span",{class:F(["w-1.5 h-1.5 rounded-full",r.getStatusDotClasses(o.status)])},null,2),m(" "+l(o.status),1)],2)]),e("td",Fe,[e("div",je,[x(c,{to:`/recurring-invoices/${o.id}`,class:"p-1.5 text-gray-600 hover:text-brand-600 dark:text-gray-400 dark:hover:text-brand-400",title:"View"},{default:u(()=>[...t[16]||(t[16]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])]),_:1},8,["to"]),o.status==="active"?(i(),d("button",{key:0,onClick:g=>r.generateNow(o),class:"p-1.5 text-gray-600 hover:text-green-600 dark:text-gray-400 dark:hover:text-green-400",title:"Generate Invoice Now"},[...t[17]||(t[17]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)])],8,Me)):n("v-if",!0),o.status==="active"?(i(),d("button",{key:1,onClick:g=>r.pauseSchedule(o),class:"p-1.5 text-gray-600 hover:text-yellow-600 dark:text-gray-400 dark:hover:text-yellow-400",title:"Pause"},[...t[18]||(t[18]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],8,ze)):n("v-if",!0),o.status==="paused"?(i(),d("button",{key:2,onClick:g=>r.resumeSchedule(o),class:"p-1.5 text-gray-600 hover:text-green-600 dark:text-gray-400 dark:hover:text-green-400",title:"Resume"},[...t[19]||(t[19]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],8,Be)):n("v-if",!0),o.status!=="cancelled"?(i(),b(c,{key:3,to:`/recurring-invoices/${o.id}/edit`,class:"p-1.5 text-gray-600 hover:text-brand-600 dark:text-gray-400 dark:hover:text-brand-400",title:"Edit"},{default:u(()=>[...t[20]||(t[20]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])]),_:1},8,["to"])):n("v-if",!0),["active","paused"].includes(o.status)?(i(),d("button",{key:4,onClick:g=>r.cancelSchedule(o),class:"p-1.5 text-gray-600 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400",title:"Cancel"},[...t[21]||(t[21]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Le)):n("v-if",!0)])])]))),128))])])])],2112))])])]),_:1})}const De=T(G,[["render",Ne],["__scopeId","data-v-9fdf316b"],["__file","/home/btafoya/projects/openclient/resources/js/src/views/RecurringInvoices/RecurringList.vue"]]);export{De as default};
