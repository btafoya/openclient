import{_ as G,b as J,h as K,i as j,I as U,H as N,r as g,u as P,k as T,o as l,e,d as a,c as i,F as S,t as x,l as E,j as p,C as Q,w as u,v as k,g as W,z as M,E as X}from"./main-DU5QQqOg.js";import{u as z}from"./projects-BLWT7ZT5.js";import{u as H}from"./clients-C2hMtF4k.js";import{A as Y}from"./AdminLayout-k0cXXt9e.js";import"./index-B9ygI19o.js";const Z={__name:"ProjectEdit",setup(I,{expose:t}){t();const c=U(),r=N(),y=z(),v=H(),b=g(!1),o=g(null),V=g([]),_=g(!1),w=g(null),D=g(!1),C=g(!1),h=P({}),d=P({name:"",description:"",client_id:"",status:"planning",priority:"medium",budget:"",start_date:"",end_date:"",is_active:!0});async function B(){var n,m;b.value=!0,o.value=null;try{const s=await y.fetchProject(c.params.id);d.name=s.name||"",d.description=s.description||"",d.client_id=s.client_id||"",d.status=s.status||"planning",d.priority=s.priority||"medium",d.budget=s.budget||"",d.start_date=s.start_date?s.start_date.split("T")[0]:"",d.end_date=s.end_date?s.end_date.split("T")[0]:"",d.is_active=s.is_active!==!1}catch(s){o.value=((m=(n=s.response)==null?void 0:n.data)==null?void 0:m.error)||"Failed to load project",console.error("Failed to load project:",s)}finally{b.value=!1}}async function F(){try{await v.fetchClients(!1),V.value=v.clients}catch(n){console.error("Failed to load clients:",n)}}async function R(){var n,m,s,A;if(Object.keys(h).forEach(f=>delete h[f]),w.value=null,!((n=d.name)!=null&&n.trim())){h.name="Project name is required";return}_.value=!0;try{const f={name:d.name.trim(),description:((m=d.description)==null?void 0:m.trim())||null,client_id:d.client_id||null,status:d.status,priority:d.priority,budget:d.budget?parseFloat(d.budget):null,start_date:d.start_date||null,end_date:d.end_date||null,is_active:d.is_active};await y.updateProject(c.params.id,f),r.push(`/projects/${c.params.id}`)}catch(f){w.value=((A=(s=f.response)==null?void 0:s.data)==null?void 0:A.error)||"Failed to update project",console.error("Failed to update project:",f)}finally{_.value=!1}}function O(){D.value=!0}async function q(){var n,m;C.value=!0;try{await y.deleteProject(c.params.id),r.push("/projects")}catch(s){w.value=((m=(n=s.response)==null?void 0:n.data)==null?void 0:m.error)||"Failed to delete project",console.error("Failed to delete project:",s),D.value=!1}finally{C.value=!1}}T(()=>{B(),F()});const L={route:c,router:r,projectStore:y,clientStore:v,loading:b,loadError:o,clients:V,submitting:_,submitError:w,showDeleteConfirm:D,deleting:C,errors:h,formData:d,loadProject:B,loadClients:F,handleSubmit:R,confirmDelete:O,deleteProject:q,ref:g,reactive:P,onMounted:T,get useRoute(){return U},get useRouter(){return N},get useProjectStore(){return z},get useClientStore(){return H},AdminLayout:Y};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}},$={class:"mx-auto max-w-3xl"},ee={key:0,class:"flex items-center justify-center py-12"},te={class:"rounded-lg border border-red-300 bg-red-50 p-6 dark:border-red-700 dark:bg-red-900/20"},re={class:"flex items-start gap-3"},oe={class:"flex-1"},ae={class:"mt-1 text-sm text-red-700 dark:text-red-400"},de={class:"mt-4 flex gap-3"},se={class:"mb-6"},le={class:"flex items-center gap-3"},ne={class:"rounded-lg border border-gray-200 bg-white shadow-sm dark:border-gray-800 dark:bg-gray-900"},ie={class:"mb-6"},ue={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},me={class:"sm:col-span-2"},ge={key:0,class:"mt-1 text-xs text-red-600"},be=["value"],ce={class:"relative"},fe={class:"sm:col-span-2"},xe={class:"mb-6"},pe={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ye={class:"mb-6"},ke={class:"flex items-center gap-3"},ve={key:0,class:"mb-4 rounded-lg bg-red-50 p-3 text-sm text-red-700 dark:bg-red-900/20 dark:text-red-400"},we={class:"flex justify-between border-t border-gray-200 pt-6 dark:border-gray-800"},he={class:"flex gap-3"},je=["disabled"],_e={key:0,class:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"},De={key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},Ce={class:"mx-4 w-full max-w-md rounded-lg bg-white p-6 shadow-xl dark:bg-gray-900"},Pe={class:"flex justify-end gap-3"},Se=["disabled"],Ee={key:0,class:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"};function Me(I,t,c,r,y,v){const b=J("router-link");return l(),K(r.AdminLayout,null,{default:j(()=>[e("div",$,[a(" Loading State "),r.loading?(l(),i("div",ee,[...t[10]||(t[10]=[e("div",{class:"h-12 w-12 animate-spin rounded-full border-4 border-gray-300 border-t-brand-600 dark:border-gray-700 dark:border-t-brand-500"},null,-1)])])):r.loadError?(l(),i(S,{key:1},[a(" Error State "),e("div",te,[e("div",re,[t[13]||(t[13]=e("svg",{class:"h-6 w-6 flex-shrink-0 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),e("div",oe,[t[12]||(t[12]=e("h3",{class:"text-lg font-medium text-red-800 dark:text-red-300"}," Failed to Load Project ",-1)),e("p",ae,x(r.loadError),1),e("div",de,[e("button",{onClick:r.loadProject,class:"rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600"}," Try Again "),E(b,{to:"/projects",class:"rounded-lg border border-red-600 bg-white px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 dark:border-red-500 dark:bg-gray-800 dark:text-red-400 dark:hover:bg-red-900/20"},{default:j(()=>[...t[11]||(t[11]=[p(" Back to Projects ",-1)])]),_:1})])])])])],2112)):(l(),i(S,{key:2},[a(" Edit Form "),a(" Header "),e("div",se,[e("div",le,[E(b,{to:`/projects/${r.route.params.id}`,class:"rounded-lg p-2 text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800"},{default:j(()=>[...t[14]||(t[14]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),_:1},8,["to"]),t[15]||(t[15]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Edit Project"),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Update project details and settings ")],-1))])]),a(" Form "),e("div",ne,[e("form",{onSubmit:Q(r.handleSubmit,["prevent"]),class:"p-6"},[a(" Basic Information "),e("div",ie,[t[26]||(t[26]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-white"},"Basic Information",-1)),e("div",ue,[a(" Project Name "),e("div",me,[t[16]||(t[16]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"},[p(" Project Name "),e("span",{class:"text-red-500"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>r.formData.name=o),type:"text",required:"",class:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 dark:border-gray-700 dark:bg-gray-800 dark:text-white",placeholder:"Enter project name"},null,512),[[k,r.formData.name]]),r.errors.name?(l(),i("p",ge,x(r.errors.name),1)):a("v-if",!0)]),a(" Client "),e("div",null,[t[18]||(t[18]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Client ",-1)),u(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.formData.client_id=o),class:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 dark:border-gray-700 dark:bg-gray-800 dark:text-white"},[t[17]||(t[17]=e("option",{value:""},"No Client",-1)),(l(!0),i(S,null,W(r.clients,o=>(l(),i("option",{key:o.id,value:o.id},x(o.name),9,be))),128))],512),[[M,r.formData.client_id]])]),a(" Status "),e("div",null,[t[20]||(t[20]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Status ",-1)),u(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.formData.status=o),class:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 dark:border-gray-700 dark:bg-gray-800 dark:text-white"},[...t[19]||(t[19]=[e("option",{value:"planning"},"Planning",-1),e("option",{value:"in_progress"},"In Progress",-1),e("option",{value:"on_hold"},"On Hold",-1),e("option",{value:"completed"},"Completed",-1)])],512),[[M,r.formData.status]])]),a(" Priority "),e("div",null,[t[22]||(t[22]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Priority ",-1)),u(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>r.formData.priority=o),class:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 dark:border-gray-700 dark:bg-gray-800 dark:text-white"},[...t[21]||(t[21]=[e("option",{value:"low"},"Low",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"high"},"High",-1),e("option",{value:"urgent"},"Urgent",-1)])],512),[[M,r.formData.priority]])]),a(" Budget "),e("div",null,[t[24]||(t[24]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Budget ",-1)),e("div",ce,[t[23]||(t[23]=e("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400"},"$",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>r.formData.budget=o),type:"number",step:"0.01",min:"0",class:"w-full rounded-lg border border-gray-300 pl-7 pr-3 py-2 text-sm focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 dark:border-gray-700 dark:bg-gray-800 dark:text-white",placeholder:"0.00"},null,512),[[k,r.formData.budget]])])]),a(" Description "),e("div",fe,[t[25]||(t[25]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Description ",-1)),u(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=o=>r.formData.description=o),rows:"3",class:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 dark:border-gray-700 dark:bg-gray-800 dark:text-white",placeholder:"Describe the project..."},null,512),[[k,r.formData.description]])])])]),a(" Dates "),e("div",xe,[t[29]||(t[29]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-white"},"Schedule",-1)),e("div",pe,[a(" Start Date "),e("div",null,[t[27]||(t[27]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Start Date ",-1)),u(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>r.formData.start_date=o),type:"date",class:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 dark:border-gray-700 dark:bg-gray-800 dark:text-white"},null,512),[[k,r.formData.start_date]])]),a(" End Date "),e("div",null,[t[28]||(t[28]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"}," End Date ",-1)),u(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>r.formData.end_date=o),type:"date",class:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 dark:border-gray-700 dark:bg-gray-800 dark:text-white"},null,512),[[k,r.formData.end_date]])])])]),a(" Settings "),e("div",ye,[t[31]||(t[31]=e("h2",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-white"},"Settings",-1)),e("label",ke,[u(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>r.formData.is_active=o),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-brand-600 focus:ring-brand-500 dark:border-gray-700"},null,512),[[X,r.formData.is_active]]),t[30]||(t[30]=e("div",null,[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Active Project"),e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," Active projects appear in the main project list and reports ")],-1))])]),a(" Error Message "),r.submitError?(l(),i("div",ve,x(r.submitError),1)):a("v-if",!0),a(" Actions "),e("div",we,[e("button",{type:"button",onClick:r.confirmDelete,class:"inline-flex items-center gap-2 rounded-lg border border-red-300 px-4 py-2 text-sm font-medium text-red-700 hover:bg-red-50 dark:border-red-700 dark:text-red-400 dark:hover:bg-red-900/20"},[...t[32]||(t[32]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),p(" Delete Project ",-1)])]),e("div",he,[E(b,{to:`/projects/${r.route.params.id}`,class:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800"},{default:j(()=>[...t[33]||(t[33]=[p(" Cancel ",-1)])]),_:1},8,["to"]),e("button",{type:"submit",disabled:r.submitting,class:"inline-flex items-center gap-2 rounded-lg bg-brand-600 px-4 py-2 text-sm font-medium text-white hover:bg-brand-700 disabled:opacity-50 dark:bg-brand-500 dark:hover:bg-brand-600"},[r.submitting?(l(),i("span",_e)):a("v-if",!0),p(" "+x(r.submitting?"Saving...":"Save Changes"),1)],8,je)])])],32)])],64)),a(" Delete Confirmation Modal "),r.showDeleteConfirm?(l(),i("div",De,[e("div",Ce,[t[34]||(t[34]=e("div",{class:"mb-4 flex items-center gap-3 text-red-600 dark:text-red-400"},[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("h3",{class:"text-lg font-semibold"},"Delete Project")],-1)),t[35]||(t[35]=e("p",{class:"mb-2 text-sm text-gray-600 dark:text-gray-400"}," Are you sure you want to delete this project? This will also delete: ",-1)),t[36]||(t[36]=e("ul",{class:"mb-4 ml-4 list-disc text-sm text-gray-600 dark:text-gray-400"},[e("li",null,"All tasks associated with this project"),e("li",null,"All time entries for this project")],-1)),t[37]||(t[37]=e("p",{class:"mb-4 text-sm font-medium text-red-600 dark:text-red-400"}," This action cannot be undone. ",-1)),e("div",Pe,[e("button",{onClick:t[9]||(t[9]=o=>r.showDeleteConfirm=!1),class:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800"}," Cancel "),e("button",{onClick:r.deleteProject,disabled:r.deleting,class:"inline-flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700 disabled:opacity-50"},[r.deleting?(l(),i("span",Ee)):a("v-if",!0),p(" "+x(r.deleting?"Deleting...":"Delete Project"),1)],8,Se)])])])):a("v-if",!0)])]),_:1})}const Ue=G(Z,[["render",Me],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Projects/ProjectEdit.vue"]]);export{Ue as default};
