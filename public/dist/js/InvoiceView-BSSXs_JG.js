import{_ as O,b as E,h as _,i as v,I as C,H as I,r as f,q as k,k as D,o,e as t,d as i,c as s,F as b,l as h,t as a,j as c,n as j,g as Q}from"./main-CeUa7Jrx.js";import{u as P}from"./invoices-Cw5eD3L8.js";import{A as U}from"./AdminLayout-B_43-oU8.js";import"./index-B9ygI19o.js";const q={__name:"InvoiceView",setup(S,{expose:e}){e();const u=C(),r=I(),l=P(),m=f(!0),x=f(null),d=k(()=>l.currentInvoice),g=k(()=>!d.value||d.value.status==="paid"||d.value.status==="cancelled"||!d.value.due_date?!1:new Date(d.value.due_date)<new Date);async function w(){var n,y;m.value=!0,x.value=null;try{await l.fetchInvoice(u.params.id)}catch(R){x.value=((y=(n=R.response)==null?void 0:n.data)==null?void 0:y.error)||"Failed to load invoice"}finally{m.value=!1}}async function M(){if(confirm("Send this invoice to the client?"))try{await l.sendInvoice(d.value.id)}catch{alert("Failed to send invoice. Please try again.")}}async function B(){if(confirm("Resend this invoice to the client?"))try{await l.resendInvoice(d.value.id),alert("Invoice resent successfully")}catch{alert("Failed to resend invoice. Please try again.")}}async function T(){if(confirm("Mark this invoice as paid?"))try{await l.markPaid(d.value.id)}catch{alert("Failed to mark as paid. Please try again.")}}async function F(){if(confirm("Are you sure you want to cancel this invoice? This action cannot be undone."))try{await l.updateStatus(d.value.id,"cancelled")}catch{alert("Failed to cancel invoice. Please try again.")}}async function L(){try{await l.previewPdf(d.value.id)}catch{alert("Failed to preview PDF. Please try again.")}}async function A(){try{await l.downloadPdf(d.value.id)}catch{alert("Failed to download PDF. Please try again.")}}function V(n){return Number(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function z(n){return n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—"}function H(n){return n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—"}function N(n){const y={draft:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400",sent:"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400",viewed:"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400",paid:"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400",overdue:"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400",cancelled:"bg-gray-100 text-gray-500 dark:bg-gray-800 dark:text-gray-500"};return y[n]||y.draft}D(()=>{w()});const p={route:u,router:r,invoiceStore:l,loading:m,error:x,invoice:d,isOverdue:g,loadInvoice:w,sendInvoice:M,resendInvoice:B,markAsPaid:T,cancelInvoice:F,previewPdf:L,downloadPdf:A,formatCurrency:V,formatDate:z,formatDateTime:H,getStatusClasses:N,ref:f,computed:k,onMounted:D,get useRoute(){return C},get useRouter(){return I},get useInvoiceStore(){return P},AdminLayout:U};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}},G={class:"space-y-6"},J={key:0,class:"flex items-center justify-center py-12"},K={class:"p-8 text-center"},W={class:"mt-4 text-sm text-gray-900 dark:text-white font-medium"},X={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Y={class:"flex items-center gap-3"},Z={class:"text-2xl font-bold text-gray-900 dark:text-white"},$={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},tt={class:"flex flex-wrap gap-2"},et={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},rt={class:"lg:col-span-2 space-y-6"},it={class:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] p-6"},at={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},ot={class:"text-gray-900 dark:text-white font-medium"},st={key:0,class:"text-sm text-gray-600 dark:text-gray-400 whitespace-pre-line"},nt={key:1,class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},dt={key:0},lt={class:"text-gray-900 dark:text-white"},ct={key:0,class:"text-sm font-normal"},gt={class:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] overflow-hidden"},xt={class:"min-w-full"},yt={class:"divide-y divide-gray-200 dark:divide-gray-700"},vt={class:"px-6 py-4"},mt={class:"text-gray-900 dark:text-white"},ut={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},ft={class:"px-6 py-4 text-right text-gray-600 dark:text-gray-400"},kt={class:"px-6 py-4 text-right text-gray-600 dark:text-gray-400"},bt={class:"px-6 py-4 text-right font-medium text-gray-900 dark:text-white"},ht={key:0},wt={class:"border-t border-gray-200 dark:border-gray-700 p-6 bg-gray-50 dark:bg-gray-800/50"},pt={class:"flex flex-col items-end space-y-2"},_t={class:"flex justify-between w-64"},Ct={class:"text-gray-900 dark:text-white"},It={key:0,class:"flex justify-between w-64"},Dt={class:"text-red-600"},jt={key:1,class:"flex justify-between w-64"},Pt={class:"text-gray-600 dark:text-gray-400"},St={class:"text-gray-900 dark:text-white"},Mt={class:"flex justify-between w-64 pt-2 border-t border-gray-200 dark:border-gray-700"},Bt={class:"text-lg font-bold text-gray-900 dark:text-white"},Tt={key:0,class:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] p-6"},Ft={class:"text-gray-600 dark:text-gray-400 whitespace-pre-line"},Lt={key:1,class:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] p-6"},At={class:"text-gray-600 dark:text-gray-400 whitespace-pre-line"},Vt={class:"space-y-6"},zt={class:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] p-6"},Ht={class:"space-y-4"},Nt={class:"text-2xl font-bold text-gray-900 dark:text-white"},Rt={key:0},Ot={class:"text-gray-900 dark:text-white"},Et={key:1},Qt={class:"text-gray-900 dark:text-white capitalize"},Ut={class:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] p-6"},qt={class:"space-y-4"},Gt={class:"flex items-start gap-3"},Jt={class:"text-xs text-gray-500 dark:text-gray-400"},Kt={key:0,class:"flex items-start gap-3"},Wt={class:"text-xs text-gray-500 dark:text-gray-400"},Xt={key:1,class:"flex items-start gap-3"},Yt={class:"text-xs text-gray-500 dark:text-gray-400"},Zt={key:2,class:"flex items-start gap-3"},$t={class:"text-xs text-gray-500 dark:text-gray-400"},te={class:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] p-6"},ee={class:"space-y-2"};function re(S,e,u,r,l,m){const x=E("router-link");return o(),_(r.AdminLayout,null,{default:v(()=>{var d;return[t("div",G,[i(" Loading State "),r.loading?(o(),s("div",J,[...e[0]||(e[0]=[t("div",{class:"inline-block w-8 h-8 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"},null,-1)])])):r.error?(o(),s(b,{key:1},[i(" Error State "),t("div",K,[e[2]||(e[2]=t("div",{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/20"},[t("svg",{class:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),t("p",W,a(r.error),1),h(x,{to:"/invoices",class:"mt-4 inline-block px-4 py-2 text-sm font-medium text-brand-600 hover:text-brand-700"},{default:v(()=>[...e[1]||(e[1]=[c(" Back to Invoices ",-1)])]),_:1})])],2112)):r.invoice?(o(),s(b,{key:2},[i(" Invoice Content "),i(" Page Header "),t("div",X,[t("div",null,[t("div",Y,[h(x,{to:"/invoices",class:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"},{default:v(()=>[...e[3]||(e[3]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1}),t("h1",Z,a(r.invoice.invoice_number),1),t("span",{class:j(["inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-full capitalize",r.getStatusClasses(r.invoice.status)])},a(r.invoice.status),3)]),t("p",$," Created "+a(r.formatDate(r.invoice.created_at)),1)]),t("div",tt,[t("button",{onClick:r.previewPdf,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600"},[...e[4]||(e[4]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),c(" Preview ",-1)])]),t("button",{onClick:r.downloadPdf,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600"},[...e[5]||(e[5]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),c(" Download PDF ",-1)])]),r.invoice.status==="draft"?(o(),s("button",{key:0,onClick:r.sendInvoice,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700"},[...e[6]||(e[6]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1),c(" Send Invoice ",-1)])])):i("v-if",!0),["sent","viewed","overdue"].includes(r.invoice.status)?(o(),s("button",{key:1,onClick:r.markAsPaid,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700"},[...e[7]||(e[7]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),c(" Mark as Paid ",-1)])])):i("v-if",!0),r.invoice.status==="draft"?(o(),_(x,{key:2,to:`/invoices/${r.invoice.id}/edit`,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-lg hover:bg-brand-700"},{default:v(()=>[...e[8]||(e[8]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),c(" Edit ",-1)])]),_:1},8,["to"])):i("v-if",!0)])]),i(" Invoice Details Grid "),t("div",et,[i(" Main Invoice Details "),t("div",rt,[i(" Client & Project Info "),t("div",it,[e[13]||(e[13]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Invoice Details",-1)),t("div",at,[i(" Bill To "),t("div",null,[e[9]||(e[9]=t("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"},"Bill To",-1)),t("p",ot,a(r.invoice.client_name||"No client"),1),r.invoice.client_address?(o(),s("p",st,a(r.invoice.client_address),1)):i("v-if",!0),r.invoice.client_email?(o(),s("p",nt,a(r.invoice.client_email),1)):i("v-if",!0)]),i(" Project "),r.invoice.project_name?(o(),s("div",dt,[e[10]||(e[10]=t("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"},"Project",-1)),h(x,{to:`/projects/${r.invoice.project_id}`,class:"text-brand-600 hover:text-brand-700 font-medium"},{default:v(()=>[c(a(r.invoice.project_name),1)]),_:1},8,["to"])])):i("v-if",!0),i(" Invoice Date "),t("div",null,[e[11]||(e[11]=t("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"},"Invoice Date",-1)),t("p",lt,a(r.formatDate(r.invoice.invoice_date)),1)]),i(" Due Date "),t("div",null,[e[12]||(e[12]=t("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"},"Due Date",-1)),t("p",{class:j(["font-medium",r.isOverdue?"text-red-600":"text-gray-900 dark:text-white"])},[c(a(r.formatDate(r.invoice.due_date))+" ",1),r.isOverdue?(o(),s("span",ct,"(Overdue)")):i("v-if",!0)],2)])])]),i(" Line Items "),t("div",gt,[e[19]||(e[19]=t("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Line Items")],-1)),t("table",xt,[e[15]||(e[15]=t("thead",null,[t("tr",{class:"border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50"},[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400"},"Description"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400"},"Qty"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400"},"Rate"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400"},"Amount")])],-1)),t("tbody",yt,[(o(!0),s(b,null,Q(r.invoice.line_items||[],g=>(o(),s("tr",{key:g.id},[t("td",vt,[t("p",mt,a(g.description),1),g.notes?(o(),s("p",ut,a(g.notes),1)):i("v-if",!0)]),t("td",ft,a(g.quantity),1),t("td",kt," $"+a(r.formatCurrency(g.rate)),1),t("td",bt," $"+a(r.formatCurrency(g.amount)),1)]))),128)),(d=r.invoice.line_items)!=null&&d.length?i("v-if",!0):(o(),s("tr",ht,[...e[14]||(e[14]=[t("td",{colspan:"4",class:"px-6 py-8 text-center text-gray-500 dark:text-gray-400"}," No line items ",-1)])]))])]),i(" Totals "),t("div",wt,[t("div",pt,[t("div",_t,[e[16]||(e[16]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Subtotal",-1)),t("span",Ct,"$"+a(r.formatCurrency(r.invoice.subtotal)),1)]),r.invoice.discount>0?(o(),s("div",It,[e[17]||(e[17]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Discount",-1)),t("span",Dt,"-$"+a(r.formatCurrency(r.invoice.discount)),1)])):i("v-if",!0),r.invoice.tax>0?(o(),s("div",jt,[t("span",Pt,"Tax ("+a(r.invoice.tax_rate||0)+"%)",1),t("span",St,"$"+a(r.formatCurrency(r.invoice.tax)),1)])):i("v-if",!0),t("div",Mt,[e[18]||(e[18]=t("span",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Total",-1)),t("span",Bt,"$"+a(r.formatCurrency(r.invoice.total)),1)])])])]),i(" Notes "),r.invoice.notes?(o(),s("div",Tt,[e[20]||(e[20]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Notes",-1)),t("p",Ft,a(r.invoice.notes),1)])):i("v-if",!0),i(" Terms "),r.invoice.terms?(o(),s("div",Lt,[e[21]||(e[21]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Terms & Conditions",-1)),t("p",At,a(r.invoice.terms),1)])):i("v-if",!0)]),i(" Sidebar "),t("div",Vt,[i(" Payment Info "),t("div",zt,[e[25]||(e[25]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Payment Information",-1)),t("div",Ht,[t("div",null,[e[22]||(e[22]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Amount Due",-1)),t("p",Nt,"$"+a(r.formatCurrency(r.invoice.total)),1)]),r.invoice.paid_at?(o(),s("div",Rt,[e[23]||(e[23]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Paid On",-1)),t("p",Ot,a(r.formatDate(r.invoice.paid_at)),1)])):i("v-if",!0),r.invoice.payment_method?(o(),s("div",Et,[e[24]||(e[24]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Payment Method",-1)),t("p",Qt,a(r.invoice.payment_method),1)])):i("v-if",!0)])]),i(" Status History "),t("div",Ut,[e[34]||(e[34]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Activity",-1)),t("div",qt,[t("div",Gt,[e[27]||(e[27]=t("div",{class:"w-2 h-2 mt-2 rounded-full bg-green-500"},null,-1)),t("div",null,[e[26]||(e[26]=t("p",{class:"text-sm text-gray-900 dark:text-white"},"Invoice Created",-1)),t("p",Jt,a(r.formatDateTime(r.invoice.created_at)),1)])]),r.invoice.sent_at?(o(),s("div",Kt,[e[29]||(e[29]=t("div",{class:"w-2 h-2 mt-2 rounded-full bg-blue-500"},null,-1)),t("div",null,[e[28]||(e[28]=t("p",{class:"text-sm text-gray-900 dark:text-white"},"Invoice Sent",-1)),t("p",Wt,a(r.formatDateTime(r.invoice.sent_at)),1)])])):i("v-if",!0),r.invoice.viewed_at?(o(),s("div",Xt,[e[31]||(e[31]=t("div",{class:"w-2 h-2 mt-2 rounded-full bg-purple-500"},null,-1)),t("div",null,[e[30]||(e[30]=t("p",{class:"text-sm text-gray-900 dark:text-white"},"Invoice Viewed",-1)),t("p",Yt,a(r.formatDateTime(r.invoice.viewed_at)),1)])])):i("v-if",!0),r.invoice.paid_at?(o(),s("div",Zt,[e[33]||(e[33]=t("div",{class:"w-2 h-2 mt-2 rounded-full bg-green-500"},null,-1)),t("div",null,[e[32]||(e[32]=t("p",{class:"text-sm text-gray-900 dark:text-white"},"Payment Received",-1)),t("p",$t,a(r.formatDateTime(r.invoice.paid_at)),1)])])):i("v-if",!0)])]),i(" Quick Actions "),t("div",te,[e[37]||(e[37]=t("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Quick Actions",-1)),t("div",ee,[["sent","viewed"].includes(r.invoice.status)?(o(),s("button",{key:0,onClick:r.resendInvoice,class:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"},[...e[35]||(e[35]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),c(" Resend Invoice ",-1)])])):i("v-if",!0),r.invoiceStore.canTransitionTo(r.invoice.status,"cancelled")?(o(),s("button",{key:1,onClick:r.cancelInvoice,class:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-red-700 bg-red-100 rounded-lg hover:bg-red-200 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30"},[...e[36]||(e[36]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),c(" Cancel Invoice ",-1)])])):i("v-if",!0)])])])])],64)):i("v-if",!0)])]}),_:1})}const ne=O(q,[["render",re],["__file","/home/btafoya/projects/openclient/resources/js/src/views/Invoices/InvoiceView.vue"]]);export{ne as default};
